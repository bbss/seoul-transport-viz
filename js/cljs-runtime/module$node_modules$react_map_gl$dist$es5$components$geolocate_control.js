shadow$provide.module$node_modules$react_map_gl$dist$es5$components$geolocate_control=function(global,require,module,exports){function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,
Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}global=require("module$node_modules$$babel$runtime$helpers$interopRequireWildcard");module=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=
void 0;var _classCallCheck2=module(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=module(require("module$node_modules$$babel$runtime$helpers$createClass")),_assertThisInitialized2=module(require("module$node_modules$$babel$runtime$helpers$assertThisInitialized")),_inherits2=module(require("module$node_modules$$babel$runtime$helpers$inherits")),_possibleConstructorReturn2=module(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=
module(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf")),_defineProperty2=module(require("module$node_modules$$babel$runtime$helpers$defineProperty")),React=global(require("module$node_modules$react$index")),_propTypes=module(require("module$node_modules$prop_types$index")),_viewportMercatorProject=module(require("module$node_modules$viewport_mercator_project$index")),_mapboxgl=module(require("module$node_modules$react_map_gl$dist$es5$utils$mapboxgl_browser"));global=module(require("module$node_modules$react_map_gl$dist$es5$components$base_control"));
var _marker=module(require("module$node_modules$react_map_gl$dist$es5$components$marker")),_mapState=module(require("module$node_modules$react_map_gl$dist$es5$utils$map_state"));module=module(require("module$node_modules$react_map_gl$dist$es5$utils$transition_manager"));var _geolocateUtils=require("module$node_modules$react_map_gl$dist$es5$utils$geolocate_utils"),LINEAR_TRANSITION_PROPS=Object.assign({},module["default"].defaultProps,{transitionDuration:500}),noop=function(){};require=Object.assign({},
global["default"].propTypes,{className:_propTypes["default"].string,style:_propTypes["default"].object,label:_propTypes["default"].string,auto:_propTypes["default"].bool,positionOptions:_propTypes["default"].object,fitBoundsOptions:_propTypes["default"].object,trackUserLocation:_propTypes["default"].bool,showUserLocation:_propTypes["default"].bool,onViewStateChange:_propTypes["default"].func,onViewportChange:_propTypes["default"].func,onGeolocate:_propTypes["default"].func});module=Object.assign({},
global["default"].defaultProps,{className:"",style:{},label:"Geolocate",auto:!1,positionOptions:null,fitBoundsOptions:null,trackUserLocation:!1,showUserLocation:!0,onGeolocate:function(){}});global=function(_BaseControl){function GeolocateControl(){(0,_classCallCheck2["default"])(this,GeolocateControl);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=_super.call.apply(_super,[this].concat(args));(0,_defineProperty2["default"])((0,_assertThisInitialized2["default"])(_this),
"state",{supportsGeolocation:!1,markerPosition:null});(0,_defineProperty2["default"])((0,_assertThisInitialized2["default"])(_this),"_mapboxGeolocateControl",null);(0,_defineProperty2["default"])((0,_assertThisInitialized2["default"])(_this),"_geolocateButtonRef",(0,React.createRef)());(0,_defineProperty2["default"])((0,_assertThisInitialized2["default"])(_this),"_setupMapboxGeolocateControl",function(supportsGeolocation){if(supportsGeolocation){var controlOptions={showUserLocation:!1};["positionOptions",
"fitBoundsOptions","trackUserLocation"].forEach(function(prop){prop in _this.props&&null!==_this.props[prop]&&(controlOptions[prop]=_this.props[prop])});var control=new _mapboxgl["default"].GeolocateControl(controlOptions);_this._mapboxGeolocateControl=control;control._watchState="OFF";control._geolocateButton=_this._geolocateButtonRef.current;control.options.trackUserLocation&&control._geolocateButton&&control._geolocateButton.setAttribute("aria-pressed","false");control._updateMarker=_this._updateMarker;
control._updateCamera=_this._updateCamera;control._setup=!0;supportsGeolocation=_this._context.eventManager;if(control.options.trackUserLocation&&supportsGeolocation)supportsGeolocation.on("panstart",function(){"ACTIVE_LOCK"===control._watchState&&(control._watchState="BACKGROUND",control._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),control._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"))});control.on("geolocate",_this.props.onGeolocate)}else console.warn("Geolocation support is not available, the GeolocateControl will not be visible.")});
(0,_defineProperty2["default"])((0,_assertThisInitialized2["default"])(_this),"_triggerGeolocate",function(){var control=_this._mapboxGeolocateControl;control._map=_this._context.map;_this.props.showUserLocation&&(control.on("geolocate",_this._updateMarker),control.on("trackuserlocationend",_this._updateMarker));return _this._mapboxGeolocateControl.trigger()});(0,_defineProperty2["default"])((0,_assertThisInitialized2["default"])(_this),"_updateMarker",function(position){position&&_this.setState({markerPosition:position.coords})});
(0,_defineProperty2["default"])((0,_assertThisInitialized2["default"])(_this),"_getBounds",function(position){position=(new _mapboxgl["default"].LngLat(position.coords.longitude,position.coords.latitude)).toBounds(position.coords.accuracy);return[[position._ne.lng,position._ne.lat],[position._sw.lng,position._sw.lat]]});(0,_defineProperty2["default"])((0,_assertThisInitialized2["default"])(_this),"_updateCamera",function(position){var viewport=_this._context.viewport;position=_this._getBounds(position);
position=(new _viewportMercatorProject["default"](viewport)).fitBounds(position);viewport=Object.assign({},viewport,{longitude:position.longitude,latitude:position.latitude,zoom:position.zoom});viewport=new _mapState["default"](viewport);viewport=Object.assign({},viewport.getViewportProps(),LINEAR_TRANSITION_PROPS);position=_this.props.onViewportChange||_this._context.onViewportChange||noop;(_this.props.onViewStateChange||_this._context.onViewStateChange||noop)({viewState:viewport});position(viewport)});
(0,_defineProperty2["default"])((0,_assertThisInitialized2["default"])(_this),"_renderButton",function(type,label,callback){return React.createElement("button",{key:type,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(type),ref:_this._geolocateButtonRef,type:"button",title:label,onClick:callback},React.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))});(0,_defineProperty2["default"])((0,_assertThisInitialized2["default"])(_this),"_renderMarker",function(){var markerPosition=
_this.state.markerPosition,showUserLocation=_this.props.showUserLocation;return markerPosition&&showUserLocation?React.createElement(_marker["default"],{key:"location-maker",className:"mapboxgl-user-location-dot",longitude:markerPosition.longitude,latitude:markerPosition.latitude,onContextMenu:function(e){return e.preventDefault()},captureDrag:!1,captureDoubleClick:!1}):null});return _this}(0,_inherits2["default"])(GeolocateControl,_BaseControl);var _super=_createSuper(GeolocateControl);(0,_createClass2["default"])(GeolocateControl,
[{key:"componentDidMount",value:function(){var _this2=this;(0,_geolocateUtils.isGeolocationSupported)().then(function(result){_this2.setState({supportsGeolocation:result});_this2._setupMapboxGeolocateControl(result);result&&_this2.props.auto&&_this2._triggerGeolocate()})}},{key:"componentDidUpdate",value:function(prevProps){this.state.supportsGeolocation&&!prevProps.auto&&this.props.auto&&this._triggerGeolocate()}},{key:"componentWillUnmount",value:function(){if(this._mapboxGeolocateControl){var geolocationWatchID=
this._mapboxGeolocateControl._geolocationWatchID;void 0!==geolocationWatchID&&(window.navigator.geolocation.clearWatch(geolocationWatchID),this._mapboxGeolocateControl._geolocationWatchID=void 0)}}},{key:"_render",value:function(){if(!this.state.supportsGeolocation)return null;var _this$props=this.props,className=_this$props.className,style=_this$props.style;_this$props=_this$props.label;return React.createElement("div",null,this._renderMarker(),React.createElement("div",{key:"geolocate-control",
className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(className),ref:this._containerRef,style:style,onContextMenu:function(e){return e.preventDefault()}},this._renderButton("geolocate",_this$props,this._triggerGeolocate)))}}]);return GeolocateControl}(global["default"]);exports["default"]=global;(0,_defineProperty2["default"])(global,"propTypes",require);(0,_defineProperty2["default"])(global,"defaultProps",module)}
//# sourceMappingURL=module$node_modules$react_map_gl$dist$es5$components$geolocate_control.js.map
