{
"version":3,
"file":"module$node_modules$$deck_DOT_gl$core$dist$es5$viewports$globe_viewport.js",
"lineCount":12,
"mappings":"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",
"sources":["node_modules/@deck_DOT_gl/core/dist/es5/viewports/globe-viewport.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$deck_DOT_gl$core$dist$es5$viewports$globe_viewport\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _math = require(\"math.gl\");\n\nvar _viewport = _interopRequireDefault(require(\"./viewport\"));\n\nvar _constants = require(\"../lib/constants\");\n\nvar vec3 = _interopRequireWildcard(require(\"gl-matrix/vec3\"));\n\nvar vec4 = _interopRequireWildcard(require(\"gl-matrix/vec4\"));\n\nvar DEGREES_TO_RADIANS = Math.PI / 180;\nvar RADIANS_TO_DEGREES = 180 / Math.PI;\nvar EARTH_RADIUS = 6370972;\nvar GLOBE_RADIUS = 256;\n\nfunction getDistanceScales() {\n  var unitsPerMeter = GLOBE_RADIUS / EARTH_RADIUS;\n  var unitsPerDegree = Math.PI / 180 * GLOBE_RADIUS;\n  return {\n    unitsPerMeter: [unitsPerMeter, unitsPerMeter, unitsPerMeter],\n    unitsPerMeter2: [0, 0, 0],\n    metersPerUnit: [1 / unitsPerMeter, 1 / unitsPerMeter, 1 / unitsPerMeter],\n    unitsPerDegree: [unitsPerDegree, unitsPerDegree, unitsPerMeter],\n    unitsPerDegree2: [0, 0, 0],\n    degreesPerUnit: [1 / unitsPerDegree, 1 / unitsPerDegree, 1 / unitsPerMeter]\n  };\n}\n\nvar GlobeViewport = function (_Viewport) {\n  (0, _inherits2[\"default\"])(GlobeViewport, _Viewport);\n\n  function GlobeViewport() {\n    var _this;\n\n    var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    (0, _classCallCheck2[\"default\"])(this, GlobeViewport);\n    var _opts$latitude = opts.latitude,\n        latitude = _opts$latitude === void 0 ? 0 : _opts$latitude,\n        _opts$longitude = opts.longitude,\n        longitude = _opts$longitude === void 0 ? 0 : _opts$longitude,\n        _opts$zoom = opts.zoom,\n        zoom = _opts$zoom === void 0 ? 11 : _opts$zoom,\n        _opts$nearZMultiplier = opts.nearZMultiplier,\n        nearZMultiplier = _opts$nearZMultiplier === void 0 ? 0.1 : _opts$nearZMultiplier,\n        _opts$farZMultiplier = opts.farZMultiplier,\n        farZMultiplier = _opts$farZMultiplier === void 0 ? 1 : _opts$farZMultiplier,\n        _opts$resolution = opts.resolution,\n        resolution = _opts$resolution === void 0 ? 10 : _opts$resolution;\n    var width = opts.width,\n        height = opts.height,\n        _opts$altitude = opts.altitude,\n        altitude = _opts$altitude === void 0 ? 1.5 : _opts$altitude;\n    width = width || 1;\n    height = height || 1;\n    altitude = Math.max(0.75, altitude);\n    var viewMatrix = new _math.Matrix4().lookAt({\n      eye: [0, -altitude, 0],\n      up: [0, 0, 1]\n    });\n    var scale = Math.pow(2, zoom);\n    viewMatrix.rotateX(latitude * DEGREES_TO_RADIANS);\n    viewMatrix.rotateZ(-longitude * DEGREES_TO_RADIANS);\n    viewMatrix.scale(scale / height);\n    var halfFov = Math.atan(0.5 / altitude);\n    var relativeScale = GLOBE_RADIUS * 2 * scale / height;\n    var viewportOpts = Object.assign({}, opts, {\n      width: width,\n      height: height,\n      viewMatrix: viewMatrix,\n      longitude: longitude,\n      latitude: latitude,\n      zoom: zoom,\n      fovyRadians: halfFov * 2,\n      aspect: width / height,\n      focalDistance: altitude,\n      near: nearZMultiplier,\n      far: Math.min(2, 1 / relativeScale + 1) * altitude * farZMultiplier\n    });\n    _this = (0, _possibleConstructorReturn2[\"default\"])(this, (0, _getPrototypeOf2[\"default\"])(GlobeViewport).call(this, viewportOpts));\n    _this.resolution = resolution;\n    _this.distanceScales = getDistanceScales();\n    return _this;\n  }\n\n  (0, _createClass2[\"default\"])(GlobeViewport, [{\n    key: \"getDistanceScales\",\n    value: function getDistanceScales() {\n      return this.distanceScales;\n    }\n  }, {\n    key: \"unproject\",\n    value: function unproject(xyz) {\n      var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          _ref$topLeft = _ref.topLeft,\n          topLeft = _ref$topLeft === void 0 ? true : _ref$topLeft,\n          targetZ = _ref.targetZ;\n\n      var _xyz = (0, _slicedToArray2[\"default\"])(xyz, 3),\n          x = _xyz[0],\n          y = _xyz[1],\n          z = _xyz[2];\n\n      var y2 = topLeft ? y : this.height - y;\n      var pixelUnprojectionMatrix = this.pixelUnprojectionMatrix;\n      var coord;\n\n      if (Number.isFinite(z)) {\n        coord = transformVector(pixelUnprojectionMatrix, [x, y2, z, 1]);\n      } else {\n        var coord0 = transformVector(pixelUnprojectionMatrix, [x, y2, -1, 1]);\n        var coord1 = transformVector(pixelUnprojectionMatrix, [x, y2, 1, 1]);\n        var lt = ((targetZ || 0) / EARTH_RADIUS + 1) * GLOBE_RADIUS;\n        var lSqr = vec3.sqrLen(vec3.sub([], coord0, coord1));\n        var l0Sqr = vec3.sqrLen(coord0);\n        var l1Sqr = vec3.sqrLen(coord1);\n        var sSqr = (4 * l0Sqr * l1Sqr - Math.pow(lSqr - l0Sqr - l1Sqr, 2)) / 16;\n        var dSqr = 4 * sSqr / lSqr;\n        var r0 = Math.sqrt(l0Sqr - dSqr);\n        var dr = Math.sqrt(Math.max(0, lt * lt - dSqr));\n        var t = (r0 - dr) / Math.sqrt(lSqr);\n        coord = vec3.lerp([], coord0, coord1, t);\n      }\n\n      var _this$unprojectPositi = this.unprojectPosition(coord),\n          _this$unprojectPositi2 = (0, _slicedToArray2[\"default\"])(_this$unprojectPositi, 3),\n          X = _this$unprojectPositi2[0],\n          Y = _this$unprojectPositi2[1],\n          Z = _this$unprojectPositi2[2];\n\n      if (Number.isFinite(z)) {\n        return [X, Y, Z];\n      }\n\n      return Number.isFinite(targetZ) ? [X, Y, targetZ] : [X, Y];\n    }\n  }, {\n    key: \"projectPosition\",\n    value: function projectPosition(xyz) {\n      var _xyz2 = (0, _slicedToArray2[\"default\"])(xyz, 3),\n          lng = _xyz2[0],\n          lat = _xyz2[1],\n          _xyz2$ = _xyz2[2],\n          Z = _xyz2$ === void 0 ? 0 : _xyz2$;\n\n      var lambda = lng * DEGREES_TO_RADIANS;\n      var phi = lat * DEGREES_TO_RADIANS;\n      var cosPhi = Math.cos(phi);\n      var D = (Z / EARTH_RADIUS + 1) * GLOBE_RADIUS;\n      return [Math.sin(lambda) * cosPhi * D, -Math.cos(lambda) * cosPhi * D, Math.sin(phi) * D];\n    }\n  }, {\n    key: \"unprojectPosition\",\n    value: function unprojectPosition(xyz) {\n      var _xyz3 = (0, _slicedToArray2[\"default\"])(xyz, 3),\n          x = _xyz3[0],\n          y = _xyz3[1],\n          z = _xyz3[2];\n\n      var D = vec3.len(xyz);\n      var phi = Math.asin(z / D);\n      var lambda = Math.atan2(x, -y);\n      var lng = lambda * RADIANS_TO_DEGREES;\n      var lat = phi * RADIANS_TO_DEGREES;\n      var Z = (D / GLOBE_RADIUS - 1) * EARTH_RADIUS;\n      return [lng, lat, Z];\n    }\n  }, {\n    key: \"projectFlat\",\n    value: function projectFlat(xyz) {\n      return xyz;\n    }\n  }, {\n    key: \"unprojectFlat\",\n    value: function unprojectFlat(xyz) {\n      return xyz;\n    }\n  }, {\n    key: \"getMapCenterByLngLatPosition\",\n    value: function getMapCenterByLngLatPosition(_ref2) {\n      var lngLat = _ref2.lngLat,\n          pos = _ref2.pos;\n      var fromPosition = this.unproject(pos);\n      return [lngLat[0] - fromPosition[0] + this.longitude, lngLat[1] - fromPosition[1] + this.latitude];\n    }\n  }, {\n    key: \"projectionMode\",\n    get: function get() {\n      return _constants.PROJECTION_MODE.GLOBE;\n    }\n  }]);\n  return GlobeViewport;\n}(_viewport[\"default\"]);\n\nexports[\"default\"] = GlobeViewport;\n\nfunction transformVector(matrix, vector) {\n  var result = vec4.transformMat4([], vector, matrix);\n  vec4.scale(result, result, 1 / result[3]);\n  return result;\n}\n//# sourceMappingURL=globe-viewport.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","transformVector","matrix","vector","result","vec4","transformMat4","scale","_interopRequireWildcard","_interopRequireDefault","Object","defineProperty","value","_slicedToArray2","_classCallCheck2","_createClass2","_possibleConstructorReturn2","_getPrototypeOf2","_inherits2","_math","_viewport","_constants","vec3","DEGREES_TO_RADIANS","Math","PI","RADIANS_TO_DEGREES","GlobeViewport","_Viewport","opts","arguments","length","undefined","_opts$latitude","latitude","_opts$longitude","longitude","_opts$zoom","zoom","_opts$nearZMultiplier","nearZMultiplier","_opts$farZMultiplier","farZMultiplier","_opts$resolution","resolution","width","height","_opts$altitude","altitude","max","viewMatrix","lookAt","Matrix4","eye","up","pow","rotateX","rotateZ","viewportOpts","assign","fovyRadians","atan","halfFov","aspect","focalDistance","near","far","min","_this","call","unitsPerMeter","GLOBE_RADIUS","EARTH_RADIUS","unitsPerDegree","distanceScales","unitsPerMeter2","metersPerUnit","unitsPerDegree2","degreesPerUnit","key","getDistanceScales","unproject","xyz","_ref","_ref$topLeft","topLeft","targetZ","_xyz","x","y","z","y2","pixelUnprojectionMatrix","Number","isFinite","coord","coord0","coord1","lt","lSqr","sqrLen","sub","l0Sqr","l1Sqr","dSqr","lerp","sqrt","r0","dr","_this$unprojectPositi","unprojectPosition","_this$unprojectPositi2","X","Y","Z","projectPosition","_xyz2","_xyz2$","lambda","lng","phi","lat","cosPhi","cos","D","sin","_xyz3","len","atan2","asin","projectFlat","unprojectFlat","getMapCenterByLngLatPosition","_ref2","lngLat","fromPosition","pos","get","PROJECTION_MODE","GLOBE"]
}
