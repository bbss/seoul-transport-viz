{
"version":3,
"file":"module$node_modules$$deck_DOT_gl$core$dist$es5$lib$view_manager.js",
"lineCount":12,
"mappings":"AAAAA,cAAA,gEAAA,CAAoF,QAAQ,CAACC,MAAD,CAAQC,OAAR,CAAgBC,MAAhB,CAAuBC,OAAvB,CAAgC,CAGxHC,MAAAA,CAAyBH,OAAA,CAAQ,kEAAR,CAE7BI,OAAAC,eAAA,CAAsBH,OAAtB,CAA+B,YAA/B,CAA6C,CAC3CI,MAAO,CAAA,CADoC,CAA7C,CAGAJ,QAAA,CAAQ,SAAR,CAAA,CAAqB,IAAK,EAE1B,KAAIK,iBAAmBJ,MAAA,CAAuBH,OAAA,CAAQ,2DAAR,CAAvB,CAAvB,CAEIQ,cAAgBL,MAAA,CAAuBH,OAAA,CAAQ,wDAAR,CAAvB,CAFpB,CAIIS,QAAUN,MAAA,CAAuBH,OAAA,CAAQ,6DAAR,CAAvB,CAJd;AAMIU,WAAaV,OAAA,CAAQ,iEAAR,CANjB,CAQIW,KAAOR,MAAA,CAAuBH,OAAA,CAAQ,0DAAR,CAAvB,CARX,CAUIY,SAAWZ,OAAA,CAAQ,8DAAR,CAEXa,QAAAA,CAAc,QAAS,EAAG,CAC5BA,QAASA,YAAW,EAAG,CACrB,IAAIC,MAA2B,CAAnB,CAAAC,SAAAC,OAAA,EAAyCC,IAAAA,EAAzC,GAAwBF,SAAA,CAAU,CAAV,CAAxB,CAAqDA,SAAA,CAAU,CAAV,CAArD,CAAoE,EAChF,EAAC,CAAA,CAAGR,gBAAA,CAAiB,SAAjB,CAAJ,EAAiC,IAAjC,CAAuCM,WAAvC,CACA,KAAAK,MAAA,CAAa,EAEb,KAAAC,OAAA,CADA,IAAAC,MACA,CADa,GAEb,KAAAC,UAAA,CAAiB,EACjB,KAAAC,YAAA,CAAmB,EACnB,KAAAC,SAAA;AAAgBT,KAAAS,SAChB,KAAAC,WAAA,CAAkB,EAClB,KAAAC,aAAA,CAAoB,EACpB,KAAAC,YAAA,CAAmB,CAAA,CACnB,KAAAC,aAAA,CAAoB,gBACpB,KAAAC,aAAA,CAAoB,CAAA,CACpB,KAAAC,cAAA,CAAqBf,KAAAgB,aACrB,KAAAC,gBAAA,CAAuB,CACrBC,kBAAmBlB,KAAAkB,kBADE,CAErBC,yBAA0BnB,KAAAmB,yBAFL,CAIvB7B,OAAA8B,KAAA,CAAY,IAAZ,CACA,KAAAC,SAAA,CAAcrB,KAAd,CApBqB,CAuBvB,CAAC,CAAA,CAAGN,aAAA,CAAc,SAAd,CAAJ,EAA8BK,WAA9B,CAA2C,CAAC,CAC1CuB,IAAK,UADqC,CAE1C9B,MAAO+B,QAAiB,EAAG,CACzB,IAAKD,IAAIA,GAAT,GAAgB,KAAAd,YAAhB,CACM,IAAAA,YAAA,CAAiBc,GAAjB,CAAJ,EACE,IAAAd,YAAA,CAAiBc,GAAjB,CAAAC,SAAA,EAIJ,KAAAf,YAAA;AAAmB,EAPM,CAFe,CAAD,CAWxC,CACDc,IAAK,aADJ,CAED9B,MAAOgC,QAAoB,EAAG,CAI5B,IAAIC,OAAS,IAAAZ,aAETa,EAL0B,CAAnBC,CAAA1B,SAAAC,OAAAyB,EAAyCxB,IAAAA,EAAzCwB,GAAwB1B,SAAA,CAAU,CAAV,CAAxB0B,CAAqD1B,SAAA,CAAU,CAAV,CAArD0B,CAAoE,CAC7ED,iBAAkB,CAAA,CAD2D,CAK3EA,kBAAJ,GACE,IAAAb,aADF,CACsB,CAAA,CADtB,CAIA,OAAOY,OAVqB,CAF7B,CAXwC,CAyBxC,CACDH,IAAK,gBADJ,CAED9B,MAAOoC,QAAuB,CAACC,MAAD,CAAS,CACrC,IAAAf,aAAA,CAAoB,IAAAA,aAApB,EAAyCe,MACzC,KAAAhB,aAAA,CAAoB,IAAAA,aAApB,EAAyCgB,MAFJ,CAFtC,CAzBwC,CA+BxC,CACDP,IAAK,kBADJ,CAED9B,MAAOsC,QAAyB,EAAG,CACjC,IAAKC,IAAIA,MAAT,GAAmB,KAAAvB,YAAnB,CAAqC,CACnC,IAAIwB,WAAa,IAAAxB,YAAA,CAAiBuB,MAAjB,CAEbC,WAAJ,EACEA,UAAAC,iBAAA,EAJiC,CADJ,CAFlC,CA/BwC;AA0CxC,CACDX,IAAK,cADJ,CAED9B,MAAO0C,QAAqB,CAACC,IAAD,CAAO,CACjC,MAAIA,KAAJ,CACS,IAAAzB,WAAA0B,OAAA,CAAuB,QAAS,CAACC,QAAD,CAAW,CAChD,MAAOA,SAAAC,cAAA,CAAuBH,IAAvB,CADyC,CAA3C,CADT,CAMO,IAAAzB,WAP0B,CAFlC,CA1CwC,CAqDxC,CACDY,IAAK,UADJ,CAED9B,MAAO+C,QAAiB,EAAG,CACzB,IAAIC,QAAU,EACd,KAAApC,MAAAqC,QAAA,CAAmB,QAAS,CAACC,IAAD,CAAO,CACjCF,OAAA,CAAQE,IAAAC,GAAR,CAAA,CAAmBD,IADc,CAAnC,CAGA,OAAOF,QALkB,CAF1B,CArDwC,CA8DxC,CACDlB,IAAK,SADJ,CAED9B,MAAOoD,QAAgB,CAACC,YAAD,CAAe,CACpC,MAA+B,QAAxB,GAAA,MAAOA,aAAP,CAAmC,IAAAzC,MAAA0C,KAAA,CAAgB,QAAS,CAACJ,IAAD,CAAO,CACxE,MAAOA,KAAAC,GAAP,GAAmBE,YADqD,CAAhC,CAAnC,CAEFA,YAH+B,CAFrC,CA9DwC,CAqExC,CACDvB,IAAK,cADJ,CAED9B,MAAOuD,QAAqB,CAAChB,MAAD,CAAS,CAEnC,IAAIxB,WADAmC,MACAnC,CADO,IAAAqC,QAAA,CAAab,MAAb,CACPxB;AAAoB,IAAAA,UAAA,CAAemC,MAAAM,eAAA,EAAf,CAApBzC,EAA6D,IAAAA,UACjE,OAAOmC,OAAA,CAAOA,MAAAO,gBAAA,CAAqB1C,SAArB,CAAP,CAAyCA,SAHb,CAFpC,CArEwC,CA4ExC,CACDe,IAAK,aADJ,CAED9B,MAAO0D,QAAoB,CAACnB,MAAD,CAAS,CAClC,MAAO,KAAApB,aAAA,CAAkBoB,MAAlB,CAD2B,CAFnC,CA5EwC,CAiFxC,CACDT,IAAK,WADJ,CAED9B,MAAO2D,QAAkB,CAACC,GAAD,CAAMzB,IAAN,CAAY,CAOnC,IANA,IAAI0B,UAAY,IAAAnB,aAAA,EAAhB,CACIoB,MAAQ,CACVC,EAAGH,GAAA,CAAI,CAAJ,CADO,CAEVI,EAAGJ,GAAA,CAAI,CAAJ,CAFO,CADZ,CAMSK,EAAIJ,SAAAnD,OAAJuD,CAAuB,CAAhC,CAAwC,CAAxC,EAAmCA,CAAnC,CAA2C,EAAEA,CAA7C,CAAgD,CAC9C,IAAIpB,SAAWgB,SAAA,CAAUI,CAAV,CAEf,IAAIpB,QAAAC,cAAA,CAAuBgB,KAAvB,CAAJ,CAIE,MAHII,IAGG,CAHCN,GAAAO,MAAA,EAGD,CAFPD,GAAA,CAAE,CAAF,CAEO,EAFCrB,QAAAkB,EAED,CADPG,GAAA,CAAE,CAAF,CACO,EADCrB,QAAAmB,EACD,CAAAnB,QAAAc,UAAA,CAAmBO,GAAnB,CAAsB/B,IAAtB,CAPqC,CAWhD,MAAO,KAlB4B,CAFpC,CAjFwC,CAuGxC,CACDL,IAAK,UADJ;AAED9B,MAAO6B,QAAiB,CAACrB,KAAD,CAAQ,CAC1B,OAAJ,EAAeA,MAAf,EACE,IAAA4D,UAAA,CAAe5D,KAAAI,MAAf,CAGE,YAAJ,EAAmBJ,MAAnB,EACE,IAAA6D,cAAA,CAAmB7D,KAAAO,UAAnB,CAGF,EAAI,OAAJ,EAAeP,MAAf,EAAwB,QAAxB,EAAoCA,MAApC,GACE,IAAA8D,SAAA,CAAc9D,KAAAM,MAAd,CAA2BN,KAAAK,OAA3B,CAGG,KAAAO,YAAL,EACE,IAAAmD,QAAA,EAd4B,CAF/B,CAvGwC,CA0HxC,CACDzC,IAAK,SADJ,CAED9B,MAAOuE,QAAgB,EAAG,CACxB,IAAAnD,YAAA,CAAmB,CAAA,CAEf,KAAAE,aAAJ,GACE,IAAAA,aAEA,CAFoB,CAAA,CAEpB,CAAA,IAAAkD,kBAAA,EAHF,CAMI,KAAAlD,aAAJ,GACE,IAAAA,aAEA,CAFoB,CAAA,CAEpB,CAAA,IAAAkD,kBAAA,EAHF,CAMA,KAAApD,YAAA,CAAmB,CAAA,CAfK,CAFzB,CA1HwC,CA6IxC,CACDU,IAAK,UADJ,CAED9B,MAAOsE,QAAiB,CAACxD,KAAD,CAAQD,MAAR,CAAgB,CACtC,CAAC,CAAA,CAAGV,OAAA,CAAQ,SAAR,CAAJ,EAAwBsE,MAAAC,SAAA,CAAgB5D,KAAhB,CAAxB;AAAkD2D,MAAAC,SAAA,CAAgB7D,MAAhB,CAAlD,CAEA,IAAIC,KAAJ,GAAc,IAAAA,MAAd,EAA4BD,MAA5B,GAAuC,IAAAA,OAAvC,CACE,IAAAC,MAEA,CAFaA,KAEb,CADA,IAAAD,OACA,CADcA,MACd,CAAA,IAAAuB,eAAA,CAAoB,cAApB,CANoC,CAFvC,CA7IwC,CAwJxC,CACDN,IAAK,WADJ,CAED9B,MAAOoE,QAAkB,CAACxD,KAAD,CAAQ,CAC/BA,KAAA,CAAQ,CAAC,CAAA,CAAGN,QAAAqE,QAAJ,EAAsB/D,KAAtB,CAA6BgE,OAA7B,CAEW,KAAAC,WAAAC,CAAgBlE,KAAhBkE,CAAuB,IAAAlE,MAAvBkE,CAEnB,EACE,IAAA1C,eAAA,CAAoB,eAApB,CAGF,KAAAxB,MAAA,CAAaA,KATkB,CAFhC,CAxJwC,CAqKxC,CACDkB,IAAK,eADJ,CAED9B,MAAOqE,QAAsB,CAACtD,SAAD,CAAY,CACnCA,SAAJ,EAC0BgE,CAAC,CAAA,CAAG3E,UAAA4E,UAAJD,EAA0BhE,SAA1BgE,CAAqC,IAAAhE,UAArCgE,CAMxB,EAHE,IAAA3C,eAAA,CAAoB,mBAApB,CAGF,CAAA,IAAArB,UAAA,CAAiBA,SAPnB,EASEV,IAAA,CAAK,SAAL,CAAA4E,KAAA,CAAqB,2CAArB,CAAA,EAVqC,CAFxC,CArKwC;AAoLxC,CACDnD,IAAK,oBADJ,CAED9B,MAAOkF,QAA2B,CAAC3C,MAAD,CAAS4C,KAAT,CAAgB,CAChDA,KAAA5C,OAAA,CAAeA,MAEf,KAAAd,gBAAAC,kBAAA,CAAuCyD,KAAvC,CAHgD,CAFjD,CApLwC,CA2LxC,CACDrD,IAAK,mBADJ,CAED9B,MAAOoF,QAA0B,CAAC5E,KAAD,CAAQ,CAQvC,MANiBgC,KADAhC,KAAA6E,KACA7C,CAAe1C,MAAAwF,OAAA,CAAc,CAC5CrE,SAAU,IAAAA,SADkC,CAE5CO,aAAc,IAAAD,cAF8B,CAG5CG,kBAAmB,IAAAwD,mBAAAK,KAAA,CAA6B,IAA7B,CAAmC/E,KAAA2C,GAAnC,CAHyB,CAI5CqC,cAAe,IAAA/D,gBAAAE,yBAJ6B,CAAd,CAK7BnB,KAL6B,CAAfgC,CAFsB,CAFxC,CA3LwC,CAuMxC,CACDV,IAAK,mBADJ,CAED9B,MAAOyF,QAA0B,CAACvC,IAAD,CAAOnC,SAAP,CAAkB8B,QAAlB,CAA4BL,UAA5B,CAAwC,CACvE,MAAIU,KAAAV,WAAJ,EACMkD,IAcGlD,CAde1C,MAAAwF,OAAA,CAAc,EAAd;AAAkBpC,IAAAV,WAAlB,CAAmCzB,SAAnC,CAA8C,CAClEoC,GAAID,IAAAC,GAD8D,CAElEY,EAAGlB,QAAAkB,EAF+D,CAGlEC,EAAGnB,QAAAmB,EAH+D,CAIlElD,MAAO+B,QAAA/B,MAJ2D,CAKlED,OAAQgC,QAAAhC,OAL0D,CAA9C,CAcf2B,CANHA,UAAJ,CACEA,UAAAX,SAAA,CAAoB6D,IAApB,CADF,CAGElD,UAHF,CAGe,IAAA4C,kBAAA,CAAuBM,IAAvB,CAGRlD,CAAAA,UAfT,EAkBO,IAnBgE,CAFxE,CAvMwC,CA8NxC,CACDV,IAAK,mBADJ,CAED9B,MAAOwE,QAA0B,EAAG,CAAA,IAC9B1D,MAAQ,IAAAA,MADsB,CAE9BD,OAAS,IAAAA,OAFqB,CAG9BD,MAAQ,IAAAA,MAHsB,CAI9B+E,eAAiB,IAAA3E,YACrB,KAAAE,WAAA,CAAkB,EAClB,KAAAF,YAAA,CAAmB,EAEnB,KAAK,IAAIiD,EAAIrD,KAAAF,OAAb,CAA2BuD,CAAA,EAA3B,CAAA,CAAiC,CAC/B,IAAIf,KAAOtC,KAAA,CAAMqD,CAAN,CAAX,CACIlD,UAAY,IAAAwC,aAAA,CAAkBL,IAAlB,CADhB,CAEIL,SAAWK,IAAA0C,aAAA,CAAkB,CAC/B9E,MAAOA,KADwB,CAE/BD,OAAQA,MAFuB;AAG/BE,UAAWA,SAHoB,CAAlB,CAKf,KAAAC,YAAA,CAAiBkC,IAAAC,GAAjB,CAAA,CAA4B,IAAAsC,kBAAA,CAAuBvC,IAAvB,CAA6BnC,SAA7B,CAAwC8B,QAAxC,CAAkD8C,cAAA,CAAezC,IAAAC,GAAf,CAAlD,CAE5B,KAAAjC,WAAA2E,QAAA,CAAwBhD,QAAxB,CAV+B,CAajC,IAAKM,IAAIA,EAAT,GAAewC,eAAf,CACMA,cAAA,CAAexC,EAAf,CAAJ,EAA0B,CAAC,IAAAnC,YAAA,CAAiBmC,EAAjB,CAA3B,EACEwC,cAAA,CAAexC,EAAf,CAAApB,SAAA,EAIJ,KAAA+D,kBAAA,EA3BkC,CAFnC,CA9NwC,CA6PxC,CACDhE,IAAK,mBADJ,CAED9B,MAAO8F,QAA0B,EAAG,CAClC,IAAIC,MAAQ,IAEZ,KAAA5E,aAAA,CAAoB,EAEpB,KAAAD,WAAA+B,QAAA,CAAwB,QAAS,CAACJ,QAAD,CAAW,CACtCA,QAAAM,GAAJ,GACE4C,KAAA5E,aAAA,CAAmB0B,QAAAM,GAAnB,CADF,CACoC4C,KAAA5E,aAAA,CAAmB0B,QAAAM,GAAnB,CADpC,EACuEN,QADvE,CAD0C,CAA5C,CALkC,CAFnC,CA7PwC,CA0QxC,CACDf,IAAK,YADJ;AAED9B,MAAO6E,QAAmB,CAACmB,QAAD,CAAWC,QAAX,CAAqB,CAC7C,MAAID,SAAAtF,OAAJ,GAAwBuF,QAAAvF,OAAxB,CACS,CAAA,CADT,CAIOsF,QAAAE,KAAA,CAAc,QAAS,CAACC,CAAD,CAAIlC,CAAJ,CAAO,CACnC,MAAO,CAAC+B,QAAA,CAAS/B,CAAT,CAAAmC,OAAA,CAAmBH,QAAA,CAAShC,CAAT,CAAnB,CAD2B,CAA9B,CALsC,CAF9C,CA1QwC,CAA3C,CAsRA,OAAO1D,YA9SqB,CAAZ,EAiTlBX,QAAA,CAAQ,SAAR,CAAA,CAAqBW,OAvUuG;",
"sources":["node_modules/@deck_DOT_gl/core/dist/es5/lib/view-manager.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$deck_DOT_gl$core$dist$es5$lib$view_manager\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _assert = _interopRequireDefault(require(\"../utils/assert\"));\n\nvar _deepEqual = require(\"../utils/deep-equal\");\n\nvar _log = _interopRequireDefault(require(\"../utils/log\"));\n\nvar _flatten = require(\"../utils/flatten\");\n\nvar ViewManager = function () {\n  function ViewManager() {\n    var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    (0, _classCallCheck2[\"default\"])(this, ViewManager);\n    this.views = [];\n    this.width = 100;\n    this.height = 100;\n    this.viewState = {};\n    this.controllers = {};\n    this.timeline = props.timeline;\n    this._viewports = [];\n    this._viewportMap = {};\n    this._isUpdating = false;\n    this._needsRedraw = 'Initial render';\n    this._needsUpdate = true;\n    this._eventManager = props.eventManager;\n    this._eventCallbacks = {\n      onViewStateChange: props.onViewStateChange,\n      onInteractiveStateChange: props.onInteractiveStateChange\n    };\n    Object.seal(this);\n    this.setProps(props);\n  }\n\n  (0, _createClass2[\"default\"])(ViewManager, [{\n    key: \"finalize\",\n    value: function finalize() {\n      for (var key in this.controllers) {\n        if (this.controllers[key]) {\n          this.controllers[key].finalize();\n        }\n      }\n\n      this.controllers = {};\n    }\n  }, {\n    key: \"needsRedraw\",\n    value: function needsRedraw() {\n      var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n        clearRedrawFlags: false\n      };\n      var redraw = this._needsRedraw;\n\n      if (opts.clearRedrawFlags) {\n        this._needsRedraw = false;\n      }\n\n      return redraw;\n    }\n  }, {\n    key: \"setNeedsUpdate\",\n    value: function setNeedsUpdate(reason) {\n      this._needsUpdate = this._needsUpdate || reason;\n      this._needsRedraw = this._needsRedraw || reason;\n    }\n  }, {\n    key: \"updateViewStates\",\n    value: function updateViewStates() {\n      for (var viewId in this.controllers) {\n        var controller = this.controllers[viewId];\n\n        if (controller) {\n          controller.updateTransition();\n        }\n      }\n    }\n  }, {\n    key: \"getViewports\",\n    value: function getViewports(rect) {\n      if (rect) {\n        return this._viewports.filter(function (viewport) {\n          return viewport.containsPixel(rect);\n        });\n      }\n\n      return this._viewports;\n    }\n  }, {\n    key: \"getViews\",\n    value: function getViews() {\n      var viewMap = {};\n      this.views.forEach(function (view) {\n        viewMap[view.id] = view;\n      });\n      return viewMap;\n    }\n  }, {\n    key: \"getView\",\n    value: function getView(viewOrViewId) {\n      return typeof viewOrViewId === 'string' ? this.views.find(function (view) {\n        return view.id === viewOrViewId;\n      }) : viewOrViewId;\n    }\n  }, {\n    key: \"getViewState\",\n    value: function getViewState(viewId) {\n      var view = this.getView(viewId);\n      var viewState = view && this.viewState[view.getViewStateId()] || this.viewState;\n      return view ? view.filterViewState(viewState) : viewState;\n    }\n  }, {\n    key: \"getViewport\",\n    value: function getViewport(viewId) {\n      return this._viewportMap[viewId];\n    }\n  }, {\n    key: \"unproject\",\n    value: function unproject(xyz, opts) {\n      var viewports = this.getViewports();\n      var pixel = {\n        x: xyz[0],\n        y: xyz[1]\n      };\n\n      for (var i = viewports.length - 1; i >= 0; --i) {\n        var viewport = viewports[i];\n\n        if (viewport.containsPixel(pixel)) {\n          var p = xyz.slice();\n          p[0] -= viewport.x;\n          p[1] -= viewport.y;\n          return viewport.unproject(p, opts);\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"setProps\",\n    value: function setProps(props) {\n      if ('views' in props) {\n        this._setViews(props.views);\n      }\n\n      if ('viewState' in props) {\n        this._setViewState(props.viewState);\n      }\n\n      if ('width' in props || 'height' in props) {\n        this._setSize(props.width, props.height);\n      }\n\n      if (!this._isUpdating) {\n        this._update();\n      }\n    }\n  }, {\n    key: \"_update\",\n    value: function _update() {\n      this._isUpdating = true;\n\n      if (this._needsUpdate) {\n        this._needsUpdate = false;\n\n        this._rebuildViewports();\n      }\n\n      if (this._needsUpdate) {\n        this._needsUpdate = false;\n\n        this._rebuildViewports();\n      }\n\n      this._isUpdating = false;\n    }\n  }, {\n    key: \"_setSize\",\n    value: function _setSize(width, height) {\n      (0, _assert[\"default\"])(Number.isFinite(width) && Number.isFinite(height));\n\n      if (width !== this.width || height !== this.height) {\n        this.width = width;\n        this.height = height;\n        this.setNeedsUpdate('Size changed');\n      }\n    }\n  }, {\n    key: \"_setViews\",\n    value: function _setViews(views) {\n      views = (0, _flatten.flatten)(views, Boolean);\n\n      var viewsChanged = this._diffViews(views, this.views);\n\n      if (viewsChanged) {\n        this.setNeedsUpdate('views changed');\n      }\n\n      this.views = views;\n    }\n  }, {\n    key: \"_setViewState\",\n    value: function _setViewState(viewState) {\n      if (viewState) {\n        var viewStateChanged = !(0, _deepEqual.deepEqual)(viewState, this.viewState);\n\n        if (viewStateChanged) {\n          this.setNeedsUpdate('viewState changed');\n        }\n\n        this.viewState = viewState;\n      } else {\n        _log[\"default\"].warn('missing `viewState` or `initialViewState`')();\n      }\n    }\n  }, {\n    key: \"_onViewStateChange\",\n    value: function _onViewStateChange(viewId, event) {\n      event.viewId = viewId;\n\n      this._eventCallbacks.onViewStateChange(event);\n    }\n  }, {\n    key: \"_createController\",\n    value: function _createController(props) {\n      var Controller = props.type;\n      var controller = new Controller(Object.assign({\n        timeline: this.timeline,\n        eventManager: this._eventManager,\n        onViewStateChange: this._onViewStateChange.bind(this, props.id),\n        onStateChange: this._eventCallbacks.onInteractiveStateChange\n      }, props));\n      return controller;\n    }\n  }, {\n    key: \"_updateController\",\n    value: function _updateController(view, viewState, viewport, controller) {\n      if (view.controller) {\n        var controllerProps = Object.assign({}, view.controller, viewState, {\n          id: view.id,\n          x: viewport.x,\n          y: viewport.y,\n          width: viewport.width,\n          height: viewport.height\n        });\n\n        if (controller) {\n          controller.setProps(controllerProps);\n        } else {\n          controller = this._createController(controllerProps);\n        }\n\n        return controller;\n      }\n\n      return null;\n    }\n  }, {\n    key: \"_rebuildViewports\",\n    value: function _rebuildViewports() {\n      var width = this.width,\n          height = this.height,\n          views = this.views;\n      var oldControllers = this.controllers;\n      this._viewports = [];\n      this.controllers = {};\n\n      for (var i = views.length; i--;) {\n        var view = views[i];\n        var viewState = this.getViewState(view);\n        var viewport = view.makeViewport({\n          width: width,\n          height: height,\n          viewState: viewState\n        });\n        this.controllers[view.id] = this._updateController(view, viewState, viewport, oldControllers[view.id]);\n\n        this._viewports.unshift(viewport);\n      }\n\n      for (var id in oldControllers) {\n        if (oldControllers[id] && !this.controllers[id]) {\n          oldControllers[id].finalize();\n        }\n      }\n\n      this._buildViewportMap();\n    }\n  }, {\n    key: \"_buildViewportMap\",\n    value: function _buildViewportMap() {\n      var _this = this;\n\n      this._viewportMap = {};\n\n      this._viewports.forEach(function (viewport) {\n        if (viewport.id) {\n          _this._viewportMap[viewport.id] = _this._viewportMap[viewport.id] || viewport;\n        }\n      });\n    }\n  }, {\n    key: \"_diffViews\",\n    value: function _diffViews(newViews, oldViews) {\n      if (newViews.length !== oldViews.length) {\n        return true;\n      }\n\n      return newViews.some(function (_, i) {\n        return !newViews[i].equals(oldViews[i]);\n      });\n    }\n  }]);\n  return ViewManager;\n}();\n\nexports[\"default\"] = ViewManager;\n//# sourceMappingURL=view-manager.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","_interopRequireDefault","Object","defineProperty","value","_classCallCheck2","_createClass2","_assert","_deepEqual","_log","_flatten","ViewManager","props","arguments","length","undefined","views","height","width","viewState","controllers","timeline","_viewports","_viewportMap","_isUpdating","_needsRedraw","_needsUpdate","_eventManager","eventManager","_eventCallbacks","onViewStateChange","onInteractiveStateChange","seal","setProps","key","finalize","needsRedraw","redraw","clearRedrawFlags","opts","setNeedsUpdate","reason","updateViewStates","viewId","controller","updateTransition","getViewports","rect","filter","viewport","containsPixel","getViews","viewMap","forEach","view","id","getView","viewOrViewId","find","getViewState","getViewStateId","filterViewState","getViewport","unproject","xyz","viewports","pixel","x","y","i","p","slice","_setViews","_setViewState","_setSize","_update","_rebuildViewports","Number","isFinite","flatten","Boolean","_diffViews","viewsChanged","viewStateChanged","deepEqual","warn","_onViewStateChange","event","_createController","type","assign","bind","onStateChange","_updateController","controllerProps","oldControllers","makeViewport","unshift","_buildViewportMap","_this","newViews","oldViews","some","_","equals"]
}
