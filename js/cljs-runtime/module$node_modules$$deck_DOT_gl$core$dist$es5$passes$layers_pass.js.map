{
"version":3,
"file":"module$node_modules$$deck_DOT_gl$core$dist$es5$passes$layers_pass.js",
"lineCount":14,
"mappings":"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",
"sources":["node_modules/@deck_DOT_gl/core/dist/es5/passes/layers-pass.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$deck_DOT_gl$core$dist$es5$passes$layers_pass\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.layerIndexResolver = layerIndexResolver;\nexports[\"default\"] = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _pass = _interopRequireDefault(require(\"./pass\"));\n\nvar _core = require(\"@luma.gl/core\");\n\nvar _log = _interopRequireDefault(require(\"../utils/log\"));\n\nvar LayersPass = function (_Pass) {\n  (0, _inherits2[\"default\"])(LayersPass, _Pass);\n\n  function LayersPass() {\n    (0, _classCallCheck2[\"default\"])(this, LayersPass);\n    return (0, _possibleConstructorReturn2[\"default\"])(this, (0, _getPrototypeOf2[\"default\"])(LayersPass).apply(this, arguments));\n  }\n\n  (0, _createClass2[\"default\"])(LayersPass, [{\n    key: \"render\",\n    value: function render(props) {\n      var gl = this.gl;\n      (0, _core.setParameters)(gl, {\n        framebuffer: props.target\n      });\n      return this._drawLayers(props);\n    }\n  }, {\n    key: \"_drawLayers\",\n    value: function _drawLayers(props) {\n      var viewports = props.viewports,\n          views = props.views,\n          onViewportActive = props.onViewportActive,\n          _props$clearCanvas = props.clearCanvas,\n          clearCanvas = _props$clearCanvas === void 0 ? true : _props$clearCanvas;\n      var gl = this.gl;\n\n      if (clearCanvas) {\n        clearGLCanvas(gl);\n      }\n\n      var renderStats = [];\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = viewports[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var viewportOrDescriptor = _step.value;\n          var viewport = viewportOrDescriptor.viewport || viewportOrDescriptor;\n          var view = views && views[viewport.id];\n          onViewportActive(viewport);\n          props.view = view;\n          var subViewports = viewport.subViewports || [viewport];\n          var _iteratorNormalCompletion2 = true;\n          var _didIteratorError2 = false;\n          var _iteratorError2 = undefined;\n\n          try {\n            for (var _iterator2 = subViewports[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n              var subViewport = _step2.value;\n              props.viewport = subViewport;\n\n              var stats = this._drawLayersInViewport(gl, props);\n\n              renderStats.push(stats);\n            }\n          } catch (err) {\n            _didIteratorError2 = true;\n            _iteratorError2 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion2 && _iterator2[\"return\"] != null) {\n                _iterator2[\"return\"]();\n              }\n            } finally {\n              if (_didIteratorError2) {\n                throw _iteratorError2;\n              }\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n            _iterator[\"return\"]();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return renderStats;\n    }\n  }, {\n    key: \"_drawLayersInViewport\",\n    value: function _drawLayersInViewport(gl, _ref) {\n      var layers = _ref.layers,\n          layerFilter = _ref.layerFilter,\n          onError = _ref.onError,\n          viewport = _ref.viewport,\n          view = _ref.view,\n          _ref$pass = _ref.pass,\n          pass = _ref$pass === void 0 ? 'unknown' : _ref$pass,\n          effects = _ref.effects,\n          moduleParameters = _ref.moduleParameters;\n      var glViewport = getGLViewport(gl, {\n        viewport: viewport\n      });\n\n      if (view && view.props.clear) {\n        var clearOpts = view.props.clear === true ? {\n          color: true,\n          depth: true\n        } : view.props.clear;\n        (0, _core.withParameters)(gl, {\n          scissorTest: true,\n          scissor: glViewport\n        }, function () {\n          return (0, _core.clear)(gl, clearOpts);\n        });\n      }\n\n      var renderStatus = {\n        totalCount: layers.length,\n        visibleCount: 0,\n        compositeCount: 0,\n        pickableCount: 0\n      };\n      (0, _core.setParameters)(gl, {\n        viewport: glViewport\n      });\n      var indexResolver = layerIndexResolver();\n\n      for (var layerIndex = 0; layerIndex < layers.length; layerIndex++) {\n        var layer = layers[layerIndex];\n\n        var shouldDrawLayer = this._shouldDrawLayer(layer, viewport, pass, layerFilter);\n\n        var layerRenderIndex = indexResolver(layer, shouldDrawLayer);\n\n        if (shouldDrawLayer && layer.props.pickable) {\n          renderStatus.pickableCount++;\n        }\n\n        if (layer.isComposite) {\n          renderStatus.compositeCount++;\n        }\n\n        if (shouldDrawLayer) {\n          renderStatus.visibleCount++;\n\n          var _moduleParameters = this._getModuleParameters(layer, effects, pass, moduleParameters);\n\n          var layerParameters = this.getLayerParameters(layer, layerIndex);\n          _moduleParameters.viewport = viewport;\n\n          try {\n            layer.drawLayer({\n              moduleParameters: _moduleParameters,\n              uniforms: {\n                layerIndex: layerRenderIndex\n              },\n              parameters: layerParameters\n            });\n          } catch (err) {\n            if (onError) {\n              onError(err, layer);\n            } else {\n              _log[\"default\"].error(\"error during drawing of \".concat(layer), err)();\n            }\n          }\n        }\n      }\n\n      return renderStatus;\n    }\n  }, {\n    key: \"shouldDrawLayer\",\n    value: function shouldDrawLayer(layer) {\n      return true;\n    }\n  }, {\n    key: \"getModuleParameters\",\n    value: function getModuleParameters(layer, effects) {\n      return null;\n    }\n  }, {\n    key: \"getLayerParameters\",\n    value: function getLayerParameters(layer, layerIndex) {\n      return layer.props.parameters;\n    }\n  }, {\n    key: \"_shouldDrawLayer\",\n    value: function _shouldDrawLayer(layer, viewport, pass, layerFilter) {\n      var shouldDrawLayer = this.shouldDrawLayer(layer) && !layer.isComposite && layer.props.visible;\n\n      if (shouldDrawLayer && layerFilter) {\n        shouldDrawLayer = layerFilter({\n          layer: layer,\n          viewport: viewport,\n          isPicking: pass.startsWith('picking'),\n          renderPass: pass\n        });\n      }\n\n      return shouldDrawLayer;\n    }\n  }, {\n    key: \"_getModuleParameters\",\n    value: function _getModuleParameters(layer, effects, pass, overrides) {\n      var moduleParameters = Object.assign(Object.create(layer.props), {\n        autoWrapLongitude: layer.wrapLongitude,\n        viewport: layer.context.viewport,\n        mousePosition: layer.context.mousePosition,\n        pickingActive: 0,\n        devicePixelRatio: (0, _core.cssToDeviceRatio)(this.gl)\n      });\n\n      if (effects) {\n        var _iteratorNormalCompletion3 = true;\n        var _didIteratorError3 = false;\n        var _iteratorError3 = undefined;\n\n        try {\n          for (var _iterator3 = effects[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n            var effect = _step3.value;\n            Object.assign(moduleParameters, effect.getModuleParameters(layer));\n          }\n        } catch (err) {\n          _didIteratorError3 = true;\n          _iteratorError3 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion3 && _iterator3[\"return\"] != null) {\n              _iterator3[\"return\"]();\n            }\n          } finally {\n            if (_didIteratorError3) {\n              throw _iteratorError3;\n            }\n          }\n        }\n      }\n\n      return Object.assign(moduleParameters, this.getModuleParameters(layer, effects), overrides);\n    }\n  }]);\n  return LayersPass;\n}(_pass[\"default\"]);\n\nexports[\"default\"] = LayersPass;\n\nfunction layerIndexResolver() {\n  var startIndex = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  var layerIndices = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var resolvers = {};\n  return function (layer, isDrawn) {\n    var indexOverride = layer.props._offset;\n    var layerId = layer.id;\n    var parentId = layer.parent && layer.parent.id;\n    var index;\n\n    if (parentId in resolvers) {\n      var resolver = resolvers[parentId] = resolvers[parentId] || layerIndexResolver(layerIndices[parentId], layerIndices);\n      index = resolver(layer, isDrawn);\n      resolvers[layerId] = resolver;\n    } else if (Number.isFinite(indexOverride)) {\n      index = indexOverride + (layerIndices[parentId] || 0);\n      resolvers[layerId] = null;\n    } else {\n      index = startIndex;\n    }\n\n    if (isDrawn && index >= startIndex) {\n      startIndex = index + 1;\n    }\n\n    layerIndices[layerId] = index;\n    return index;\n  };\n}\n\nfunction getGLViewport(gl, _ref2) {\n  var viewport = _ref2.viewport;\n  var height = gl.canvas ? gl.canvas.clientHeight || gl.canvas.height : 100;\n  var dimensions = viewport;\n  var pixelRatio = (0, _core.cssToDeviceRatio)(gl);\n  return [dimensions.x * pixelRatio, (height - dimensions.y - dimensions.height) * pixelRatio, dimensions.width * pixelRatio, dimensions.height * pixelRatio];\n}\n\nfunction clearGLCanvas(gl) {\n  var width = gl.drawingBufferWidth;\n  var height = gl.drawingBufferHeight;\n  (0, _core.setParameters)(gl, {\n    viewport: [0, 0, width, height]\n  });\n  gl.clear(16384 | 256);\n}\n//# sourceMappingURL=layers-pass.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","layerIndexResolver","startIndex","arguments","length","undefined","layerIndices","resolvers","layer","isDrawn","indexOverride","props","_offset","layerId","id","parentId","parent","resolver","index","Number","isFinite","getGLViewport","gl","_ref2","height","canvas","clientHeight","dimensions","viewport","pixelRatio","_core","cssToDeviceRatio","x","y","width","_interopRequireDefault","Object","defineProperty","value","_classCallCheck2","_createClass2","_possibleConstructorReturn2","_getPrototypeOf2","_inherits2","_pass","_log","LayersPass","_Pass","apply","key","render","setParameters","framebuffer","target","_drawLayers","viewports","views","onViewportActive","_props$clearCanvas","clearCanvas","drawingBufferWidth","drawingBufferHeight","clear","renderStats","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","Symbol","iterator","_step","done","next","viewportOrDescriptor","view","subViewports","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","stats","_drawLayersInViewport","push","err","_ref","layers","layerFilter","onError","_ref$pass","pass","effects","moduleParameters","glViewport","clearOpts","color","depth","withParameters","scissorTest","scissor","renderStatus","totalCount","visibleCount","compositeCount","pickableCount","indexResolver","layerIndex","shouldDrawLayer","_shouldDrawLayer","layerRenderIndex","pickable","isComposite","_moduleParameters","_getModuleParameters","layerParameters","getLayerParameters","drawLayer","uniforms","parameters","error","concat","getModuleParameters","visible","isPicking","startsWith","renderPass","overrides","assign","create","autoWrapLongitude","wrapLongitude","context","mousePosition","pickingActive","devicePixelRatio","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_iterator3","_step3"]
}
