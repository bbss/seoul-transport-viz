shadow$provide.module$node_modules$$deck_DOT_gl$aggregation_layers$dist$es5$cpu_grid_layer$grid_aggregator=function(global,require,module,exports){global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports.pointToDensityGridDataCPU=function(props,aggregationParams){var _props$data=props.data,data=void 0===_props$data?[]:_props$data,cellSize=props.cellSize,attributes=aggregationParams.attributes;props=aggregationParams.viewport;
_props$data=aggregationParams.projectPoints;var numInstances=aggregationParams.numInstances,positions=attributes.positions.value,size=attributes.positions.getAccessor().size,JSCompiler_temp;if(!(JSCompiler_temp=aggregationParams.boundingBox)){JSCompiler_temp=attributes.positions;attributes=JSCompiler_temp.value;JSCompiler_temp=JSCompiler_temp.getAccessor().size;for(var yMin=Infinity,yMax=-Infinity,xMin=Infinity,xMax=-Infinity,y,x,i=0;i<numInstances;i++)x=attributes[i*JSCompiler_temp],y=attributes[i*
JSCompiler_temp+1],Number.isFinite(x)&&Number.isFinite(y)&&(yMin=y<yMin?y:yMin,yMax=y>yMax?y:yMax,xMin=x<xMin?x:xMin,xMax=x>xMax?x:xMax);JSCompiler_temp={xMin:xMin,xMax:xMax,yMin:yMin,yMax:yMax}}attributes=JSCompiler_temp;numInstances=aggregationParams.posOffset||[180,90];aggregationParams=aggregationParams.gridOffset||(0,_gridAggregationUtils.getGridOffset)(attributes,cellSize);if(0>=aggregationParams.xOffset||0>=aggregationParams.yOffset){var JSCompiler_object_inline_gridHash_6579={};var JSCompiler_object_inline_gridOffset_6580=
aggregationParams;var JSCompiler_object_inline_offsets_6581=void 0}else{cellSize=Math.ceil(props.width/aggregationParams.xOffset);attributes=Math.ceil(props.height/aggregationParams.yOffset);JSCompiler_temp={};yMin=(0,_core.createIterable)(data);data=yMin.iterable;yMin=yMin.objectInfo;yMax=Array(3);xMin=!0;xMax=!1;y=void 0;try{for(JSCompiler_object_inline_gridHash_6579=data[Symbol.iterator]();!(xMin=(JSCompiler_object_inline_gridOffset_6580=JSCompiler_object_inline_gridHash_6579.next()).done);xMin=
!0){var pt=JSCompiler_object_inline_gridOffset_6580.value;yMin.index++;yMax[0]=positions[yMin.index*size];yMax[1]=positions[yMin.index*size+1];yMax[2]=3<=size?positions[yMin.index*size+2]:0;var _ref=_props$data?props.project(yMax):yMax;JSCompiler_object_inline_offsets_6581=(0,_slicedToArray2["default"])(_ref,2);var x$jscomp$0=JSCompiler_object_inline_offsets_6581[0],y$jscomp$0=JSCompiler_object_inline_offsets_6581[1];if(Number.isFinite(x$jscomp$0)&&Number.isFinite(y$jscomp$0)){var yIndex=Math.floor((y$jscomp$0+
numInstances[1])/aggregationParams.yOffset),xIndex=Math.floor((x$jscomp$0+numInstances[0])/aggregationParams.xOffset);if(!_props$data||0<=xIndex&&xIndex<cellSize&&0<=yIndex&&yIndex<attributes){var key="".concat(yIndex,"-").concat(xIndex);JSCompiler_temp[key]=JSCompiler_temp[key]||{count:0,points:[],lonIdx:xIndex,latIdx:yIndex};JSCompiler_temp[key].count+=1;JSCompiler_temp[key].points.push(pt)}}}}catch(err){xMax=!0,y=err}finally{try{if(!xMin&&null!=JSCompiler_object_inline_gridHash_6579["return"])JSCompiler_object_inline_gridHash_6579["return"]()}finally{if(xMax)throw y;
}}JSCompiler_object_inline_gridHash_6579=JSCompiler_temp;JSCompiler_object_inline_gridOffset_6580=aggregationParams;JSCompiler_object_inline_offsets_6581=[-1*numInstances[0],-1*numInstances[1]]}pt=JSCompiler_object_inline_gridHash_6579;_ref=JSCompiler_object_inline_gridOffset_6580;x$jscomp$0=Array(Object.keys(pt).length);y$jscomp$0=0;for(var key$jscomp$0 in pt)xIndex=key$jscomp$0.split("-"),yIndex=parseInt(xIndex[0],10),xIndex=parseInt(xIndex[1],10),key=y$jscomp$0++,x$jscomp$0[key]=Object.assign({index:key,
position:[JSCompiler_object_inline_offsets_6581[0]+_ref.xOffset*xIndex,JSCompiler_object_inline_offsets_6581[1]+_ref.yOffset*yIndex]},pt[key$jscomp$0]);return{gridHash:JSCompiler_object_inline_gridHash_6579,gridOffset:JSCompiler_object_inline_gridOffset_6580,data:x$jscomp$0}};var _slicedToArray2=global(require("module$node_modules$$babel$runtime$helpers$slicedToArray")),_core=require("module$node_modules$$deck_DOT_gl$core$dist$es5$index"),_gridAggregationUtils=require("module$node_modules$$deck_DOT_gl$aggregation_layers$dist$es5$utils$grid_aggregation_utils")}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$aggregation_layers$dist$es5$cpu_grid_layer$grid_aggregator.js.map
