shadow$provide.module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$query=function(global,require,module,exports){global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _classCallCheck2=global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_possibleConstructorReturn2=global(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=
global(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf")),_assertThisInitialized2=global(require("module$node_modules$$babel$runtime$helpers$assertThisInitialized")),_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),_inherits2=global(require("module$node_modules$$babel$runtime$helpers$inherits"));global=global(require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$resource"));var _features=require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$features$index"),
_gltools=require("module$node_modules$$luma_DOT_gl$gltools$dist$es5$index"),_utils=require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$utils$index");require=function(_Resource){function Query(gl){var _this=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(0,_classCallCheck2["default"])(this,Query);_this=(0,_possibleConstructorReturn2["default"])(this,(0,_getPrototypeOf2["default"])(Query).call(this,gl,_this));_this.target=null;_this._queryPending=!1;_this._pollingPromise=null;Object.seal((0,
_assertThisInitialized2["default"])(_this));return _this}(0,_inherits2["default"])(Query,_Resource);(0,_createClass2["default"])(Query,null,[{key:"isSupported",value:function(gl){var opts=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],webgl2=(0,_gltools.isWebGL2)(gl),hasTimerQuery=(0,_features.hasFeatures)(gl,_features.FEATURES.TIMER_QUERY),supported=webgl2||hasTimerQuery,_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _iterator=opts[Symbol.iterator](),
_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0)switch(_step.value){case "queries":supported=supported&&webgl2;break;case "timers":supported=supported&&hasTimerQuery;break;default:(0,_utils.assert)(!1)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&null!=_iterator["return"])_iterator["return"]()}finally{if(_didIteratorError)throw _iteratorError;}}return supported}}]);(0,_createClass2["default"])(Query,[{key:"beginTimeElapsedQuery",
value:function(){return this.begin(35007)}},{key:"beginOcclusionQuery",value:function(){var _ref$conservative=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).conservative;return this.begin((void 0===_ref$conservative?0:_ref$conservative)?36202:35887)}},{key:"beginTransformFeedbackQuery",value:function(){return this.begin(35976)}},{key:"begin",value:function(target){if(this._queryPending)return this;this.target=target;this.gl.beginQuery(this.target,this.handle);return this}},{key:"end",
value:function(){if(this._queryPending)return this;this.target&&(this.gl.endQuery(this.target),this.target=null,this._queryPending=!0);return this}},{key:"isResultAvailable",value:function(){if(!this._queryPending)return!1;var resultAvailable=this.gl.getQueryParameter(this.handle,34919);resultAvailable&&(this._queryPending=!1);return resultAvailable}},{key:"isTimerDisjoint",value:function(){return this.gl.getParameter(36795)}},{key:"getResult",value:function(){return this.gl.getQueryParameter(this.handle,
34918)}},{key:"getTimerMilliseconds",value:function(){return this.getResult()/1E6}},{key:"createPoll",value:function(){var _this2=this,limit=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;var counter=0;return this._pollingPromise=new Promise(function(resolve,reject){requestAnimationFrame(function poll(){_this2.isResultAvailable()?(resolve(_this2.getResult()),_this2._pollingPromise=null):counter++>limit?(reject("Timed out"),
_this2._pollingPromise=null):requestAnimationFrame(poll)})})}},{key:"_createHandle",value:function(){return Query.isSupported(this.gl)?this.gl.createQuery():null}},{key:"_deleteHandle",value:function(){this.gl.deleteQuery(this.handle)}}]);return Query}(global["default"]);exports["default"]=require}
//# sourceMappingURL=module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$query.js.map
