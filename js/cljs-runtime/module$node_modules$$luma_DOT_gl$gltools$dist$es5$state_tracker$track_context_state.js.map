{
"version":3,
"file":"module$node_modules$$luma_DOT_gl$gltools$dist$es5$state_tracker$track_context_state.js",
"lineCount":9,
"mappings":"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",
"sources":["node_modules/@luma_DOT_gl/gltools/dist/es5/state-tracker/track-context-state.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$luma_DOT_gl$gltools$dist$es5$state_tracker$track_context_state\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = trackContextState;\nexports.pushContextState = pushContextState;\nexports.popContextState = popContextState;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _webglParameterTables = require(\"./webgl-parameter-tables\");\n\nvar _unifiedParameterApi = require(\"./unified-parameter-api\");\n\nvar _utils = require(\"../utils\");\n\nfunction installGetterOverride(gl, functionName) {\n  var originalGetterFunc = gl[functionName].bind(gl);\n\n  gl[functionName] = function get() {\n    var pname = arguments.length <= 0 ? undefined : arguments[0];\n\n    if (!(pname in gl.state.cache)) {\n      gl.state.cache[pname] = originalGetterFunc.apply(void 0, arguments);\n    }\n\n    return gl.state.enable ? gl.state.cache[pname] : originalGetterFunc.apply(void 0, arguments);\n  };\n\n  Object.defineProperty(gl[functionName], 'name', {\n    value: \"\".concat(functionName, \"-from-cache\"),\n    configurable: false\n  });\n}\n\nfunction installSetterSpy(gl, functionName, setter) {\n  var originalSetterFunc = gl[functionName].bind(gl);\n\n  gl[functionName] = function set() {\n    for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n      params[_key] = arguments[_key];\n    }\n\n    var _setter = setter.apply(void 0, [gl.state._updateCache].concat(params)),\n        valueChanged = _setter.valueChanged,\n        oldValue = _setter.oldValue;\n\n    if (valueChanged) {\n      originalSetterFunc.apply(void 0, params);\n    }\n\n    return oldValue;\n  };\n\n  Object.defineProperty(gl[functionName], 'name', {\n    value: \"\".concat(functionName, \"-to-cache\"),\n    configurable: false\n  });\n}\n\nfunction installProgramSpy(gl) {\n  var originalUseProgram = gl.useProgram.bind(gl);\n\n  gl.useProgram = function useProgramLuma(handle) {\n    if (gl.state.program !== handle) {\n      originalUseProgram(handle);\n      gl.state.program = handle;\n    }\n  };\n}\n\nvar GLState = function () {\n  function GLState(gl) {\n    var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n        _ref$copyState = _ref.copyState,\n        copyState = _ref$copyState === void 0 ? false : _ref$copyState,\n        _ref$log = _ref.log,\n        log = _ref$log === void 0 ? function () {} : _ref$log;\n\n    (0, _classCallCheck2[\"default\"])(this, GLState);\n    this.gl = gl;\n    this.program = null;\n    this.stateStack = [];\n    this.enable = true;\n    this.cache = copyState ? (0, _unifiedParameterApi.getParameters)(gl) : Object.assign({}, _webglParameterTables.GL_PARAMETER_DEFAULTS);\n    this.log = log;\n    this._updateCache = this._updateCache.bind(this);\n    Object.seal(this);\n  }\n\n  (0, _createClass2[\"default\"])(GLState, [{\n    key: \"push\",\n    value: function push() {\n      var values = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      this.stateStack.push({});\n    }\n  }, {\n    key: \"pop\",\n    value: function pop() {\n      (0, _utils.assert)(this.stateStack.length > 0);\n      var oldValues = this.stateStack[this.stateStack.length - 1];\n      (0, _unifiedParameterApi.setParameters)(this.gl, oldValues, this.cache);\n      this.stateStack.pop();\n    }\n  }, {\n    key: \"_updateCache\",\n    value: function _updateCache(values) {\n      var valueChanged = false;\n      var oldValue;\n      var oldValues = this.stateStack.length > 0 && this.stateStack[this.stateStack.length - 1];\n\n      for (var key in values) {\n        (0, _utils.assert)(key !== undefined);\n        var value = values[key];\n        var cached = this.cache[key];\n\n        if (!(0, _utils.deepArrayEqual)(value, cached)) {\n          valueChanged = true;\n          oldValue = cached;\n\n          if (oldValues && !(key in oldValues)) {\n            oldValues[key] = cached;\n          }\n\n          this.cache[key] = value;\n        }\n      }\n\n      return {\n        valueChanged: valueChanged,\n        oldValue: oldValue\n      };\n    }\n  }]);\n  return GLState;\n}();\n\nfunction trackContextState(gl) {\n  var _ref2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n      _ref2$enable = _ref2.enable,\n      enable = _ref2$enable === void 0 ? true : _ref2$enable,\n      copyState = _ref2.copyState;\n\n  (0, _utils.assert)(copyState !== undefined);\n\n  if (!gl.state) {\n    var global_ = typeof global !== 'undefined' ? global : window;\n\n    if (global_.polyfillContext) {\n      global_.polyfillContext(gl);\n    }\n\n    gl.state = new GLState(gl, {\n      copyState: copyState,\n      enable: enable\n    });\n    installProgramSpy(gl);\n\n    for (var key in _webglParameterTables.GL_HOOKED_SETTERS) {\n      var setter = _webglParameterTables.GL_HOOKED_SETTERS[key];\n      installSetterSpy(gl, key, setter);\n    }\n\n    installGetterOverride(gl, 'getParameter');\n    installGetterOverride(gl, 'isEnabled');\n  }\n\n  gl.state.enable = enable;\n  return gl;\n}\n\nfunction pushContextState(gl) {\n  if (!gl.state) {\n    trackContextState(gl, {\n      copyState: false\n    });\n  }\n\n  gl.state.push();\n}\n\nfunction popContextState(gl) {\n  (0, _utils.assert)(gl.state);\n  gl.state.pop();\n}\n//# sourceMappingURL=track-context-state.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","installGetterOverride","gl","functionName","originalGetterFunc","bind","pname","arguments","length","undefined","state","cache","apply","enable","Object","defineProperty","value","concat","configurable","installSetterSpy","setter","originalSetterFunc","_len","params","Array","_key","_setter","_updateCache","oldValue","valueChanged","installProgramSpy","originalUseProgram","useProgram","gl.useProgram","handle","program","trackContextState","_ref2","_ref2$enable","copyState","_utils","assert","global_","window","polyfillContext","GLState","key","_webglParameterTables","GL_HOOKED_SETTERS","_interopRequireDefault","pushContextState","push","popContextState","pop","_classCallCheck2","_createClass2","_unifiedParameterApi","_ref","_ref$copyState","_ref$log","log","stateStack","getParameters","assign","GL_PARAMETER_DEFAULTS","seal","oldValues","setParameters","values","cached","deepArrayEqual"]
}
