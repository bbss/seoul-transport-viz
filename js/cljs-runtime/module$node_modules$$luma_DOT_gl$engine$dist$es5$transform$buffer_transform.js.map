{
"version":3,
"file":"module$node_modules$$luma_DOT_gl$engine$dist$es5$transform$buffer_transform.js",
"lineCount":12,
"mappings":"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",
"sources":["node_modules/@luma_DOT_gl/engine/dist/es5/transform/buffer-transform.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$luma_DOT_gl$engine$dist$es5$transform$buffer_transform\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _gltools = require(\"@luma.gl/gltools\");\n\nvar _webgl = require(\"@luma.gl/webgl\");\n\nvar BufferTransform = function () {\n  function BufferTransform(gl) {\n    var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    (0, _classCallCheck2[\"default\"])(this, BufferTransform);\n    this.gl = gl;\n    this.currentIndex = 0;\n    this.feedbackMap = {};\n    this.varyings = null;\n    this.bindings = [];\n    this.resources = {};\n\n    this._initialize(props);\n\n    Object.seal(this);\n  }\n\n  (0, _createClass2[\"default\"])(BufferTransform, [{\n    key: \"setupResources\",\n    value: function setupResources(opts) {\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = this.bindings[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var binding = _step.value;\n\n          this._setupTransformFeedback(binding, opts);\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n            _iterator[\"return\"]();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    }\n  }, {\n    key: \"updateModelProps\",\n    value: function updateModelProps() {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var varyings = this.varyings;\n\n      if (varyings.length > 0) {\n        props = Object.assign({}, props, {\n          varyings: varyings\n        });\n      }\n\n      return props;\n    }\n  }, {\n    key: \"getDrawOptions\",\n    value: function getDrawOptions() {\n      var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var binding = this.bindings[this.currentIndex];\n      var sourceBuffers = binding.sourceBuffers,\n          transformFeedback = binding.transformFeedback;\n      var attributes = Object.assign({}, sourceBuffers, opts.attributes);\n      return {\n        attributes: attributes,\n        transformFeedback: transformFeedback\n      };\n    }\n  }, {\n    key: \"swap\",\n    value: function swap() {\n      if (this.feedbackMap) {\n        this.currentIndex = this._getNextIndex();\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"update\",\n    value: function update() {\n      var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      this._setupBuffers(opts);\n    }\n  }, {\n    key: \"getBuffer\",\n    value: function getBuffer(varyingName) {\n      var feedbackBuffers = this.bindings[this.currentIndex].feedbackBuffers;\n      var bufferOrParams = varyingName ? feedbackBuffers[varyingName] : null;\n\n      if (!bufferOrParams) {\n        return null;\n      }\n\n      return bufferOrParams instanceof _webgl.Buffer ? bufferOrParams : bufferOrParams.buffer;\n    }\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          varyingName = _ref.varyingName;\n\n      var buffer = this.getBuffer(varyingName);\n\n      if (buffer) {\n        return buffer.getData();\n      }\n\n      return null;\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      for (var name in this.resources) {\n        this.resources[name][\"delete\"]();\n      }\n    }\n  }, {\n    key: \"_initialize\",\n    value: function _initialize() {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      this._setupBuffers(props);\n\n      this.varyings = props.varyings || Object.keys(this.bindings[this.currentIndex].feedbackBuffers);\n\n      if (this.varyings.length > 0) {\n        (0, _webgl.assert)((0, _gltools.isWebGL2)(this.gl));\n      }\n    }\n  }, {\n    key: \"_getFeedbackBuffers\",\n    value: function _getFeedbackBuffers(props) {\n      var _props$sourceBuffers = props.sourceBuffers,\n          sourceBuffers = _props$sourceBuffers === void 0 ? {} : _props$sourceBuffers;\n      var feedbackBuffers = {};\n\n      if (this.bindings[this.currentIndex]) {\n        Object.assign(feedbackBuffers, this.bindings[this.currentIndex].feedbackBuffers);\n      }\n\n      if (this.feedbackMap) {\n        for (var sourceName in this.feedbackMap) {\n          var feedbackName = this.feedbackMap[sourceName];\n\n          if (sourceName in sourceBuffers) {\n            feedbackBuffers[feedbackName] = sourceName;\n          }\n        }\n      }\n\n      Object.assign(feedbackBuffers, props.feedbackBuffers);\n\n      for (var bufferName in feedbackBuffers) {\n        var bufferOrRef = feedbackBuffers[bufferName];\n\n        if (typeof bufferOrRef === 'string') {\n          var sourceBuffer = sourceBuffers[bufferOrRef];\n          var byteLength = sourceBuffer.byteLength,\n              usage = sourceBuffer.usage,\n              accessor = sourceBuffer.accessor;\n          feedbackBuffers[bufferName] = this._createNewBuffer(bufferName, {\n            byteLength: byteLength,\n            usage: usage,\n            accessor: accessor\n          });\n        }\n      }\n\n      return feedbackBuffers;\n    }\n  }, {\n    key: \"_setupBuffers\",\n    value: function _setupBuffers() {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var _props$sourceBuffers2 = props.sourceBuffers,\n          sourceBuffers = _props$sourceBuffers2 === void 0 ? null : _props$sourceBuffers2;\n      Object.assign(this.feedbackMap, props.feedbackMap);\n\n      var feedbackBuffers = this._getFeedbackBuffers(props);\n\n      this._updateBindings({\n        sourceBuffers: sourceBuffers,\n        feedbackBuffers: feedbackBuffers\n      });\n    }\n  }, {\n    key: \"_setupTransformFeedback\",\n    value: function _setupTransformFeedback(binding, _ref2) {\n      var model = _ref2.model;\n      var program = model.program;\n      binding.transformFeedback = new _webgl.TransformFeedback(this.gl, {\n        program: program,\n        buffers: binding.feedbackBuffers\n      });\n    }\n  }, {\n    key: \"_updateBindings\",\n    value: function _updateBindings(opts) {\n      this.bindings[this.currentIndex] = this._updateBinding(this.bindings[this.currentIndex], opts);\n\n      if (this.feedbackMap) {\n        var _this$_swapBuffers = this._swapBuffers(this.bindings[this.currentIndex]),\n            sourceBuffers = _this$_swapBuffers.sourceBuffers,\n            feedbackBuffers = _this$_swapBuffers.feedbackBuffers;\n\n        var nextIndex = this._getNextIndex();\n\n        this.bindings[nextIndex] = this._updateBinding(this.bindings[nextIndex], {\n          sourceBuffers: sourceBuffers,\n          feedbackBuffers: feedbackBuffers\n        });\n      }\n    }\n  }, {\n    key: \"_updateBinding\",\n    value: function _updateBinding(binding, opts) {\n      if (!binding) {\n        return {\n          sourceBuffers: Object.assign({}, opts.sourceBuffers),\n          feedbackBuffers: Object.assign({}, opts.feedbackBuffers)\n        };\n      }\n\n      Object.assign(binding.sourceBuffers, opts.sourceBuffers);\n      Object.assign(binding.feedbackBuffers, opts.feedbackBuffers);\n\n      if (binding.transformFeedback) {\n        binding.transformFeedback.setBuffers(binding.feedbackBuffers);\n      }\n\n      return binding;\n    }\n  }, {\n    key: \"_swapBuffers\",\n    value: function _swapBuffers(opts) {\n      if (!this.feedbackMap) {\n        return null;\n      }\n\n      var sourceBuffers = Object.assign({}, opts.sourceBuffers);\n      var feedbackBuffers = Object.assign({}, opts.feedbackBuffers);\n\n      for (var srcName in this.feedbackMap) {\n        var dstName = this.feedbackMap[srcName];\n        sourceBuffers[srcName] = opts.feedbackBuffers[dstName];\n        feedbackBuffers[dstName] = opts.sourceBuffers[srcName];\n        (0, _webgl.assert)(feedbackBuffers[dstName] instanceof _webgl.Buffer);\n      }\n\n      return {\n        sourceBuffers: sourceBuffers,\n        feedbackBuffers: feedbackBuffers\n      };\n    }\n  }, {\n    key: \"_createNewBuffer\",\n    value: function _createNewBuffer(name, opts) {\n      var buffer = new _webgl.Buffer(this.gl, opts);\n\n      if (this.resources[name]) {\n        this.resources[name][\"delete\"]();\n      }\n\n      this.resources[name] = buffer;\n      return buffer;\n    }\n  }, {\n    key: \"_getNextIndex\",\n    value: function _getNextIndex() {\n      return (this.currentIndex + 1) % 2;\n    }\n  }]);\n  return BufferTransform;\n}();\n\nexports[\"default\"] = BufferTransform;\n//# sourceMappingURL=buffer-transform.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","_interopRequireDefault","Object","defineProperty","value","_classCallCheck2","_createClass2","_gltools","_webgl","BufferTransform","gl","props","arguments","length","undefined","currentIndex","feedbackMap","varyings","bindings","resources","_initialize","seal","key","setupResources","opts","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","Symbol","iterator","_step","done","next","_setupTransformFeedback","err","updateModelProps","assign","getDrawOptions","binding","transformFeedback","attributes","sourceBuffers","swap","_getNextIndex","update","_setupBuffers","getBuffer","varyingName","feedbackBuffers","bufferOrParams","Buffer","buffer","getData","_ref","_delete","name","keys","assert","isWebGL2","_getFeedbackBuffers","_props$sourceBuffers","sourceName","feedbackName","bufferName","bufferOrRef","sourceBuffer","_createNewBuffer","byteLength","usage","accessor","_props$sourceBuffers2","_updateBindings","_ref2","TransformFeedback","program","model","buffers","_updateBinding","_this$_swapBuffers","_swapBuffers","nextIndex","setBuffers","srcName","dstName"]
}
