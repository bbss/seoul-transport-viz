shadow$provide.module$node_modules$$deck_DOT_gl$core$dist$es5$controllers$map_controller=function(global,require,module,exports){var _interopRequireWildcard=require("module$node_modules$$babel$runtime$helpers$interopRequireWildcard"),_interopRequireDefault=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=exports.MapState=exports.MAPBOX_LIMITS=void 0;var _slicedToArray2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$slicedToArray")),
_classCallCheck2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$createClass")),_possibleConstructorReturn2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf")),_inherits2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$inherits")),
_math=require("module$node_modules$math_DOT_gl$dist$es5$index");global=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$controllers$controller"));module=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$controllers$view_state"));var _webMercator=_interopRequireWildcard(require("module$node_modules$$math_DOT_gl$web_mercator$dist$es5$index")),_assert=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$utils$assert"));
_interopRequireWildcard=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$transitions$linear_interpolator"));require=require("module$node_modules$$deck_DOT_gl$core$dist$es5$controllers$transition_manager");var LINEAR_TRANSITION_PROPS={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new _interopRequireWildcard["default"],transitionInterruption:require.TRANSITION_EVENTS.BREAK},NO_TRANSITION_PROPS={transitionDuration:0},MAPBOX_LIMITS=
{minZoom:0,maxZoom:20,minPitch:0,maxPitch:60};exports.MAPBOX_LIMITS=MAPBOX_LIMITS;var MapState$jscomp$0=function(_ViewState){function MapState(){var _ref=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},_ref$ViewportType=_ref.ViewportType;_ref$ViewportType=void 0===_ref$ViewportType?_webMercator["default"]:_ref$ViewportType;var _this=_ref.width;var height=_ref.height,latitude=_ref.latitude,longitude=_ref.longitude,zoom=_ref.zoom,_ref$bearing=_ref.bearing;_ref$bearing=void 0===_ref$bearing?
0:_ref$bearing;var _ref$pitch=_ref.pitch;_ref$pitch=void 0===_ref$pitch?0:_ref$pitch;var _ref$altitude=_ref.altitude;_ref$altitude=void 0===_ref$altitude?1.5:_ref$altitude;var _ref$maxZoom=_ref.maxZoom;_ref$maxZoom=void 0===_ref$maxZoom?MAPBOX_LIMITS.maxZoom:_ref$maxZoom;var _ref$minZoom=_ref.minZoom;_ref$minZoom=void 0===_ref$minZoom?MAPBOX_LIMITS.minZoom:_ref$minZoom;var _ref$maxPitch=_ref.maxPitch;_ref$maxPitch=void 0===_ref$maxPitch?MAPBOX_LIMITS.maxPitch:_ref$maxPitch;var _ref$minPitch=_ref.minPitch,
minPitch=void 0===_ref$minPitch?MAPBOX_LIMITS.minPitch:_ref$minPitch;_ref$minPitch=_ref.startPanLngLat;var startZoomLngLat=_ref.startZoomLngLat,startBearing=_ref.startBearing,startPitch=_ref.startPitch;_ref=_ref.startZoom;(0,_classCallCheck2["default"])(this,MapState);(0,_assert["default"])(Number.isFinite(longitude),"`longitude` must be supplied");(0,_assert["default"])(Number.isFinite(latitude),"`latitude` must be supplied");(0,_assert["default"])(Number.isFinite(zoom),"`zoom` must be supplied");
_this=(0,_possibleConstructorReturn2["default"])(this,(0,_getPrototypeOf2["default"])(MapState).call(this,{width:_this,height:height,latitude:latitude,longitude:longitude,zoom:zoom,bearing:_ref$bearing,pitch:_ref$pitch,altitude:_ref$altitude,maxZoom:_ref$maxZoom,minZoom:_ref$minZoom,maxPitch:_ref$maxPitch,minPitch:minPitch}));_this._interactiveState={startPanLngLat:_ref$minPitch,startZoomLngLat:startZoomLngLat,startBearing:startBearing,startPitch:startPitch,startZoom:_ref};_this.ViewportType=_ref$ViewportType;
return _this}(0,_inherits2["default"])(MapState,_ViewState);(0,_createClass2["default"])(MapState,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(_ref2){return this._getUpdatedState({startPanLngLat:this._unproject(_ref2.pos)})}},{key:"pan",value:function(_ref3){var pos=_ref3.pos;_ref3=_ref3.startPos;_ref3=this._interactiveState.startPanLngLat||this._unproject(_ref3);if(!_ref3)return this;
pos=this._calculateNewLngLat({startPanLngLat:_ref3,pos:pos});pos=(0,_slicedToArray2["default"])(pos,2);return this._getUpdatedState({longitude:pos[0],latitude:pos[1]})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanLngLat:null})}},{key:"rotateStart",value:function(_ref4){return this._getUpdatedState({startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(_ref5){var _ref5$deltaScaleX=_ref5.deltaScaleX;_ref5$deltaScaleX=
void 0===_ref5$deltaScaleX?0:_ref5$deltaScaleX;_ref5=_ref5.deltaScaleY;_ref5=void 0===_ref5?0:_ref5;var _this$_interactiveSta=this._interactiveState,startBearing=_this$_interactiveSta.startBearing;_this$_interactiveSta=_this$_interactiveSta.startPitch;if(!Number.isFinite(startBearing)||!Number.isFinite(_this$_interactiveSta))return this;_ref5$deltaScaleX=this._calculateNewPitchAndBearing({deltaScaleX:_ref5$deltaScaleX,deltaScaleY:_ref5,startBearing:startBearing,startPitch:_this$_interactiveSta});
return this._getUpdatedState({bearing:_ref5$deltaScaleX.bearing,pitch:_ref5$deltaScaleX.pitch})}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(_ref6){return this._getUpdatedState({startZoomLngLat:this._unproject(_ref6.pos),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(_ref7){var pos=_ref7.pos,startPos=_ref7.startPos;_ref7=_ref7.scale;var _this$_interactiveSta2=this._interactiveState,startZoom=
_this$_interactiveSta2.startZoom;_this$_interactiveSta2=_this$_interactiveSta2.startZoomLngLat;Number.isFinite(startZoom)||(startZoom=this._viewportProps.zoom,_this$_interactiveSta2=this._unproject(startPos)||this._unproject(pos));startPos=this._calculateNewZoom({scale:_ref7,startZoom:startZoom});pos=(new this.ViewportType(Object.assign({},this._viewportProps,{zoom:startPos}))).getMapCenterByLngLatPosition({lngLat:_this$_interactiveSta2,pos:pos});pos=(0,_slicedToArray2["default"])(pos,2);return this._getUpdatedState({zoom:startPos,
longitude:pos[0],latitude:pos[1]})}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}},{key:"zoomIn",value:function(){return this._zoomFromCenter(2)}},{key:"zoomOut",value:function(){return this._zoomFromCenter(.5)}},{key:"moveLeft",value:function(){return this._panFromCenter([100,0])}},{key:"moveRight",value:function(){return this._panFromCenter([-100,0])}},{key:"moveUp",value:function(){return this._panFromCenter([0,100])}},{key:"moveDown",value:function(){return this._panFromCenter([0,
-100])}},{key:"rotateLeft",value:function(){return this._getUpdatedState({bearing:this._viewportProps.bearing-15})}},{key:"rotateRight",value:function(){return this._getUpdatedState({bearing:this._viewportProps.bearing+15})}},{key:"rotateUp",value:function(){return this._getUpdatedState({pitch:this._viewportProps.pitch+10})}},{key:"rotateDown",value:function(){return this._getUpdatedState({pitch:this._viewportProps.pitch-10})}},{key:"shortestPathFrom",value:function(viewState){viewState=viewState.getViewportProps();
var props=Object.assign({},this._viewportProps),bearing=props.bearing,longitude=props.longitude;180<Math.abs(bearing-viewState.bearing)&&(props.bearing=0>bearing?bearing+360:bearing-360);180<Math.abs(longitude-viewState.longitude)&&(props.longitude=0>longitude?longitude+360:longitude-360);return props}},{key:"_zoomFromCenter",value:function(scale){var _this$_viewportProps=this._viewportProps;return this.zoom({pos:[_this$_viewportProps.width/2,_this$_viewportProps.height/2],scale:scale})}},{key:"_panFromCenter",
value:function(offset){var _this$_viewportProps2=this._viewportProps,width=_this$_viewportProps2.width;_this$_viewportProps2=_this$_viewportProps2.height;return this.pan({startPos:[width/2,_this$_viewportProps2/2],pos:[width/2+offset[0],_this$_viewportProps2/2+offset[1]]})}},{key:"_getUpdatedState",value:function(newProps){return new this.constructor(Object.assign({},this._viewportProps,this._interactiveState,newProps))}},{key:"_applyConstraints",value:function(props){var maxZoom=props.maxZoom,minZoom=
props.minZoom,zoom=props.zoom;props.zoom=(0,_math.clamp)(zoom,minZoom,maxZoom);maxZoom=props.maxPitch;minZoom=props.minPitch;zoom=props.pitch;props.pitch=(0,_math.clamp)(zoom,minZoom,maxZoom);Object.assign(props,(0,_webMercator.normalizeViewportProps)(props));return props}},{key:"_unproject",value:function(pos){var viewport=new this.ViewportType(this._viewportProps);return pos&&viewport.unproject(pos)}},{key:"_calculateNewLngLat",value:function(_ref8){var startPanLngLat=_ref8.startPanLngLat;_ref8=
_ref8.pos;return(new this.ViewportType(this._viewportProps)).getMapCenterByLngLatPosition({lngLat:startPanLngLat,pos:_ref8})}},{key:"_calculateNewZoom",value:function(_ref9){var _this$_viewportProps3=this._viewportProps,maxZoom=_this$_viewportProps3.maxZoom;_this$_viewportProps3=_this$_viewportProps3.minZoom;_ref9=_ref9.startZoom+Math.log2(_ref9.scale);return(0,_math.clamp)(_ref9,_this$_viewportProps3,maxZoom)}},{key:"_calculateNewPitchAndBearing",value:function(_ref10){var deltaScaleX=_ref10.deltaScaleX,
deltaScaleY=_ref10.deltaScaleY,startBearing=_ref10.startBearing;_ref10=_ref10.startPitch;deltaScaleY=(0,_math.clamp)(deltaScaleY,-1,1);var _this$_viewportProps4=this._viewportProps,minPitch=_this$_viewportProps4.minPitch;_this$_viewportProps4=_this$_viewportProps4.maxPitch;var pitch=_ref10;0<deltaScaleY?pitch=_ref10+deltaScaleY*(_this$_viewportProps4-_ref10):0>deltaScaleY&&(pitch=_ref10-deltaScaleY*(minPitch-_ref10));return{pitch:pitch,bearing:startBearing+180*deltaScaleX}}}]);return MapState}(module["default"]);
exports.MapState=MapState$jscomp$0;require=function(_Controller){function MapController(props){(0,_classCallCheck2["default"])(this,MapController);props=(0,_possibleConstructorReturn2["default"])(this,(0,_getPrototypeOf2["default"])(MapController).call(this,MapState$jscomp$0,props));props.invertPan=!0;return props}(0,_inherits2["default"])(MapController,_Controller);(0,_createClass2["default"])(MapController,[{key:"_getTransitionProps",value:function(){return LINEAR_TRANSITION_PROPS}},{key:"_onPanRotate",
value:function(event){if(!this.dragRotate)return!1;var deltaX=event.deltaX,deltaY=event.deltaY;event=this.getCenter(event);event=(0,_slicedToArray2["default"])(event,2)[1];var startY=event-deltaY,_this$controllerState=this.controllerState.getViewportProps(),width=_this$controllerState.width;_this$controllerState=_this$controllerState.height;var deltaScaleY=0;0<deltaY?5<Math.abs(_this$controllerState-startY)&&(deltaScaleY=deltaY/(startY-_this$controllerState)*1.2):0>deltaY&&5<startY&&(deltaScaleY=
1-event/startY);deltaScaleY=Math.min(1,Math.max(-1,deltaScaleY));deltaX=this.controllerState.rotate({deltaScaleX:deltaX/width,deltaScaleY:deltaScaleY});return this.updateViewport(deltaX,NO_TRANSITION_PROPS,{isDragging:!0,isRotating:!0})}}]);return MapController}(global["default"]);exports["default"]=require}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$core$dist$es5$controllers$map_controller.js.map
