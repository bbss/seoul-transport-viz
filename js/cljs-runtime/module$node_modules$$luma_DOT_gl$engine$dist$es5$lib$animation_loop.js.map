{
"version":3,
"file":"module$node_modules$$luma_DOT_gl$engine$dist$es5$lib$animation_loop.js",
"lineCount":26,
"mappings":"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",
"sources":["node_modules/@luma_DOT_gl/engine/dist/es5/lib/animation-loop.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$luma_DOT_gl$engine$dist$es5$lib$animation_loop\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _gltools = require(\"@luma.gl/gltools\");\n\nvar _webgl = require(\"@luma.gl/webgl\");\n\nvar _env = require(\"probe.gl/env\");\n\nvar isPage = (0, _env.isBrowser)() && typeof document !== 'undefined';\nvar statIdCounter = 0;\n\nvar AnimationLoop = function () {\n  function AnimationLoop() {\n    var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    (0, _classCallCheck2[\"default\"])(this, AnimationLoop);\n    var _props$onCreateContex = props.onCreateContext,\n        onCreateContext = _props$onCreateContex === void 0 ? function (opts) {\n      return (0, _gltools.createGLContext)(opts);\n    } : _props$onCreateContex,\n        _props$onAddHTML = props.onAddHTML,\n        onAddHTML = _props$onAddHTML === void 0 ? null : _props$onAddHTML,\n        _props$onInitialize = props.onInitialize,\n        onInitialize = _props$onInitialize === void 0 ? function () {} : _props$onInitialize,\n        _props$onRender = props.onRender,\n        onRender = _props$onRender === void 0 ? function () {} : _props$onRender,\n        _props$onFinalize = props.onFinalize,\n        onFinalize = _props$onFinalize === void 0 ? function () {} : _props$onFinalize,\n        onError = props.onError,\n        _props$gl = props.gl,\n        gl = _props$gl === void 0 ? null : _props$gl,\n        _props$glOptions = props.glOptions,\n        glOptions = _props$glOptions === void 0 ? {} : _props$glOptions,\n        _props$debug = props.debug,\n        debug = _props$debug === void 0 ? false : _props$debug,\n        _props$createFramebuf = props.createFramebuffer,\n        createFramebuffer = _props$createFramebuf === void 0 ? false : _props$createFramebuf,\n        _props$autoResizeView = props.autoResizeViewport,\n        autoResizeViewport = _props$autoResizeView === void 0 ? true : _props$autoResizeView,\n        _props$autoResizeDraw = props.autoResizeDrawingBuffer,\n        autoResizeDrawingBuffer = _props$autoResizeDraw === void 0 ? true : _props$autoResizeDraw,\n        _props$stats = props.stats,\n        stats = _props$stats === void 0 ? _webgl.lumaStats.get(\"animation-loop-\".concat(statIdCounter++)) : _props$stats;\n    var _props$useDevicePixel = props.useDevicePixels,\n        useDevicePixels = _props$useDevicePixel === void 0 ? true : _props$useDevicePixel;\n\n    if ('useDevicePixelRatio' in props) {\n      _webgl.log.deprecated('useDevicePixelRatio', 'useDevicePixels')();\n\n      useDevicePixels = props.useDevicePixelRatio;\n    }\n\n    this.props = {\n      onCreateContext: onCreateContext,\n      onAddHTML: onAddHTML,\n      onInitialize: onInitialize,\n      onRender: onRender,\n      onFinalize: onFinalize,\n      onError: onError,\n      gl: gl,\n      glOptions: glOptions,\n      debug: debug,\n      createFramebuffer: createFramebuffer\n    };\n    this.gl = gl;\n    this.needsRedraw = null;\n    this.timeline = null;\n    this.stats = stats;\n    this.cpuTime = this.stats.get('CPU Time');\n    this.gpuTime = this.stats.get('GPU Time');\n    this.frameRate = this.stats.get('Frame Rate');\n    this._initialized = false;\n    this._running = false;\n    this._animationFrameId = null;\n    this._nextFramePromise = null;\n    this._resolveNextFrame = null;\n    this._cpuStartTime = 0;\n    this.setProps({\n      autoResizeViewport: autoResizeViewport,\n      autoResizeDrawingBuffer: autoResizeDrawingBuffer,\n      useDevicePixels: useDevicePixels\n    });\n    this.start = this.start.bind(this);\n    this.stop = this.stop.bind(this);\n    this._pageLoadPromise = null;\n    this._onMousemove = this._onMousemove.bind(this);\n    this._onMouseleave = this._onMouseleave.bind(this);\n  }\n\n  (0, _createClass2[\"default\"])(AnimationLoop, [{\n    key: \"delete\",\n    value: function _delete() {\n      this.stop();\n\n      this._setDisplay(null);\n    }\n  }, {\n    key: \"setNeedsRedraw\",\n    value: function setNeedsRedraw(reason) {\n      (0, _webgl.assert)(typeof reason === 'string');\n      this.needsRedraw = this.needsRedraw || reason;\n      return this;\n    }\n  }, {\n    key: \"setProps\",\n    value: function setProps(props) {\n      if ('autoResizeViewport' in props) {\n        this.autoResizeViewport = props.autoResizeViewport;\n      }\n\n      if ('autoResizeDrawingBuffer' in props) {\n        this.autoResizeDrawingBuffer = props.autoResizeDrawingBuffer;\n      }\n\n      if ('useDevicePixels' in props) {\n        this.useDevicePixels = props.useDevicePixels;\n      }\n\n      return this;\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      var _this = this;\n\n      var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      if (this._running) {\n        return this;\n      }\n\n      this._running = true;\n\n      var startPromise = this._getPageLoadPromise().then(function () {\n        if (!_this._running || _this._initialized) {\n          return null;\n        }\n\n        _this._createWebGLContext(opts);\n\n        _this._createFramebuffer();\n\n        _this._startEventHandling();\n\n        _this._initializeCallbackData();\n\n        _this._updateCallbackData();\n\n        _this._resizeCanvasDrawingBuffer();\n\n        _this._resizeViewport();\n\n        _this._gpuTimeQuery = _webgl.Query.isSupported(_this.gl, ['timers']) ? new _webgl.Query(_this.gl) : null;\n        _this._initialized = true;\n        return _this.onInitialize(_this.animationProps);\n      }).then(function (appContext) {\n        if (_this._running) {\n          _this._addCallbackData(appContext || {});\n\n          if (appContext !== false) {\n            _this._startLoop();\n          }\n        }\n      });\n\n      if (this.props.onError) {\n        startPromise[\"catch\"](this.props.onError);\n      }\n\n      return this;\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      this._beginTimers();\n\n      this._setupFrame();\n\n      this._updateCallbackData();\n\n      this._renderFrame(this.animationProps);\n\n      this._clearNeedsRedraw();\n\n      if (this.offScreen && this.gl.commit) {\n        this.gl.commit();\n      }\n\n      if (this._resolveNextFrame) {\n        this._resolveNextFrame(this);\n\n        this._nextFramePromise = null;\n        this._resolveNextFrame = null;\n      }\n\n      this._endTimers();\n\n      return this;\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      if (this._running) {\n        this._finalizeCallbackData();\n\n        (0, _webgl.cancelAnimationFrame)(this._animationFrameId);\n        this._nextFramePromise = null;\n        this._resolveNextFrame = null;\n        this._animationFrameId = null;\n        this._running = false;\n      }\n\n      return this;\n    }\n  }, {\n    key: \"attachTimeline\",\n    value: function attachTimeline(timeline) {\n      this.timeline = timeline;\n      return this.timeline;\n    }\n  }, {\n    key: \"detachTimeline\",\n    value: function detachTimeline() {\n      this.timeline = null;\n    }\n  }, {\n    key: \"waitForRender\",\n    value: function waitForRender() {\n      var _this2 = this;\n\n      this.setNeedsRedraw('waitForRender');\n\n      if (!this._nextFramePromise) {\n        this._nextFramePromise = new Promise(function (resolve) {\n          _this2._resolveNextFrame = resolve;\n        });\n      }\n\n      return this._nextFramePromise;\n    }\n  }, {\n    key: \"toDataURL\",\n    value: function () {\n      var _toDataURL = (0, _asyncToGenerator2[\"default\"])(_regenerator[\"default\"].mark(function _callee() {\n        return _regenerator[\"default\"].wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.setNeedsRedraw('toDataURL');\n                _context.next = 3;\n                return this.waitForRender();\n\n              case 3:\n                return _context.abrupt(\"return\", this.gl.canvas.toDataURL());\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function toDataURL() {\n        return _toDataURL.apply(this, arguments);\n      }\n\n      return toDataURL;\n    }()\n  }, {\n    key: \"onCreateContext\",\n    value: function onCreateContext() {\n      var _this$props;\n\n      return (_this$props = this.props).onCreateContext.apply(_this$props, arguments);\n    }\n  }, {\n    key: \"onInitialize\",\n    value: function onInitialize() {\n      var _this$props2;\n\n      return (_this$props2 = this.props).onInitialize.apply(_this$props2, arguments);\n    }\n  }, {\n    key: \"onRender\",\n    value: function onRender() {\n      var _this$props3;\n\n      return (_this$props3 = this.props).onRender.apply(_this$props3, arguments);\n    }\n  }, {\n    key: \"onFinalize\",\n    value: function onFinalize() {\n      var _this$props4;\n\n      return (_this$props4 = this.props).onFinalize.apply(_this$props4, arguments);\n    }\n  }, {\n    key: \"getHTMLControlValue\",\n    value: function getHTMLControlValue(id) {\n      var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      var element = document.getElementById(id);\n      return element ? Number(element.value) : defaultValue;\n    }\n  }, {\n    key: \"setViewParameters\",\n    value: function setViewParameters() {\n      _webgl.log.removed('AnimationLoop.setViewParameters', 'AnimationLoop.setProps')();\n\n      return this;\n    }\n  }, {\n    key: \"_startLoop\",\n    value: function _startLoop() {\n      var _this3 = this;\n\n      var renderFrame = function renderFrame() {\n        if (!_this3._running) {\n          return;\n        }\n\n        _this3.redraw();\n\n        _this3._animationFrameId = _this3._requestAnimationFrame(renderFrame);\n      };\n\n      (0, _webgl.cancelAnimationFrame)(this._animationFrameId);\n      this._animationFrameId = this._requestAnimationFrame(renderFrame);\n    }\n  }, {\n    key: \"_getPageLoadPromise\",\n    value: function _getPageLoadPromise() {\n      if (!this._pageLoadPromise) {\n        this._pageLoadPromise = isPage ? new Promise(function (resolve, reject) {\n          if (isPage && document.readyState === 'complete') {\n            resolve(document);\n            return;\n          }\n\n          window.addEventListener('load', function () {\n            resolve(document);\n          });\n        }) : Promise.resolve({});\n      }\n\n      return this._pageLoadPromise;\n    }\n  }, {\n    key: \"_setDisplay\",\n    value: function _setDisplay(display) {\n      if (this.display) {\n        this.display[\"delete\"]();\n        this.display.animationLoop = null;\n      }\n\n      if (display) {\n        display.animationLoop = this;\n      }\n\n      this.display = display;\n    }\n  }, {\n    key: \"_requestAnimationFrame\",\n    value: function _requestAnimationFrame(renderFrameCallback) {\n      if (this.display && this.display.requestAnimationFrame(renderFrameCallback)) {\n        return;\n      }\n\n      (0, _webgl.requestAnimationFrame)(renderFrameCallback);\n    }\n  }, {\n    key: \"_renderFrame\",\n    value: function _renderFrame() {\n      if (this.display) {\n        var _this$display;\n\n        (_this$display = this.display)._renderFrame.apply(_this$display, arguments);\n\n        return;\n      }\n\n      this.onRender.apply(this, arguments);\n    }\n  }, {\n    key: \"_clearNeedsRedraw\",\n    value: function _clearNeedsRedraw() {\n      this.needsRedraw = null;\n    }\n  }, {\n    key: \"_setupFrame\",\n    value: function _setupFrame() {\n      if (this._onSetupFrame) {\n        this._onSetupFrame(this.animationProps);\n      } else {\n        this._resizeCanvasDrawingBuffer();\n\n        this._resizeViewport();\n\n        this._resizeFramebuffer();\n      }\n    }\n  }, {\n    key: \"_initializeCallbackData\",\n    value: function _initializeCallbackData() {\n      this.animationProps = {\n        gl: this.gl,\n        stop: this.stop,\n        canvas: this.gl.canvas,\n        framebuffer: this.framebuffer,\n        useDevicePixels: this.useDevicePixels,\n        needsRedraw: null,\n        startTime: Date.now(),\n        engineTime: 0,\n        tick: 0,\n        tock: 0,\n        time: 0,\n        _timeline: this.timeline,\n        _loop: this,\n        _animationLoop: this,\n        _mousePosition: null\n      };\n    }\n  }, {\n    key: \"_updateCallbackData\",\n    value: function _updateCallbackData() {\n      var _this$_getSizeAndAspe = this._getSizeAndAspect(),\n          width = _this$_getSizeAndAspe.width,\n          height = _this$_getSizeAndAspe.height,\n          aspect = _this$_getSizeAndAspe.aspect;\n\n      if (width !== this.animationProps.width || height !== this.animationProps.height) {\n        this.setNeedsRedraw('drawing buffer resized');\n      }\n\n      if (aspect !== this.animationProps.aspect) {\n        this.setNeedsRedraw('drawing buffer aspect changed');\n      }\n\n      this.animationProps.width = width;\n      this.animationProps.height = height;\n      this.animationProps.aspect = aspect;\n      this.animationProps.needsRedraw = this.needsRedraw;\n      this.animationProps.engineTime = Date.now() - this.animationProps.startTime;\n\n      if (this.timeline) {\n        this.timeline.update(this.animationProps.engineTime);\n      }\n\n      this.animationProps.tick = Math.floor(this.animationProps.time / 1000 * 60);\n      this.animationProps.tock++;\n      this.animationProps.time = this.timeline ? this.timeline.getTime() : this.animationProps.engineTime;\n      this.animationProps._offScreen = this.offScreen;\n    }\n  }, {\n    key: \"_finalizeCallbackData\",\n    value: function _finalizeCallbackData() {\n      this.onFinalize(this.animationProps);\n    }\n  }, {\n    key: \"_addCallbackData\",\n    value: function _addCallbackData(appContext) {\n      if ((0, _typeof2[\"default\"])(appContext) === 'object' && appContext !== null) {\n        this.animationProps = Object.assign({}, this.animationProps, appContext);\n      }\n    }\n  }, {\n    key: \"_createWebGLContext\",\n    value: function _createWebGLContext(opts) {\n      this.offScreen = opts.canvas && typeof OffscreenCanvas !== 'undefined' && opts.canvas instanceof OffscreenCanvas;\n      opts = Object.assign({}, opts, this.props.glOptions);\n      this.gl = this.props.gl ? (0, _gltools.instrumentGLContext)(this.props.gl, opts) : this.onCreateContext(opts);\n\n      if (!(0, _gltools.isWebGL)(this.gl)) {\n        throw new Error('AnimationLoop.onCreateContext - illegal context returned');\n      }\n\n      (0, _gltools.resetParameters)(this.gl);\n\n      this._createInfoDiv();\n    }\n  }, {\n    key: \"_createInfoDiv\",\n    value: function _createInfoDiv() {\n      if (this.gl.canvas && this.props.onAddHTML) {\n        var wrapperDiv = document.createElement('div');\n        document.body.appendChild(wrapperDiv);\n        wrapperDiv.style.position = 'relative';\n        var div = document.createElement('div');\n        div.style.position = 'absolute';\n        div.style.left = '10px';\n        div.style.bottom = '10px';\n        div.style.width = '300px';\n        div.style.background = 'white';\n        wrapperDiv.appendChild(this.gl.canvas);\n        wrapperDiv.appendChild(div);\n        var html = this.props.onAddHTML(div);\n\n        if (html) {\n          div.innerHTML = html;\n        }\n      }\n    }\n  }, {\n    key: \"_getSizeAndAspect\",\n    value: function _getSizeAndAspect() {\n      var width = this.gl.drawingBufferWidth;\n      var height = this.gl.drawingBufferHeight;\n      var aspect = 1;\n      var canvas = this.gl.canvas;\n\n      if (canvas && canvas.clientHeight) {\n        aspect = canvas.clientWidth / canvas.clientHeight;\n      } else if (width > 0 && height > 0) {\n        aspect = width / height;\n      }\n\n      return {\n        width: width,\n        height: height,\n        aspect: aspect\n      };\n    }\n  }, {\n    key: \"_resizeViewport\",\n    value: function _resizeViewport() {\n      if (this.autoResizeViewport) {\n        this.gl.viewport(0, 0, this.gl.drawingBufferWidth, this.gl.drawingBufferHeight);\n      }\n    }\n  }, {\n    key: \"_resizeCanvasDrawingBuffer\",\n    value: function _resizeCanvasDrawingBuffer() {\n      if (this.autoResizeDrawingBuffer) {\n        (0, _gltools.resizeGLContext)(this.gl, {\n          useDevicePixels: this.useDevicePixels\n        });\n      }\n    }\n  }, {\n    key: \"_createFramebuffer\",\n    value: function _createFramebuffer() {\n      if (this.props.createFramebuffer) {\n        this.framebuffer = new _webgl.Framebuffer(this.gl);\n      }\n    }\n  }, {\n    key: \"_resizeFramebuffer\",\n    value: function _resizeFramebuffer() {\n      if (this.framebuffer) {\n        this.framebuffer.resize({\n          width: this.gl.drawingBufferWidth,\n          height: this.gl.drawingBufferHeight\n        });\n      }\n    }\n  }, {\n    key: \"_beginTimers\",\n    value: function _beginTimers() {\n      this.frameRate.timeEnd();\n      this.frameRate.timeStart();\n\n      if (this._gpuTimeQuery && this._gpuTimeQuery.isResultAvailable() && !this._gpuTimeQuery.isTimerDisjoint()) {\n        this.stats.get('GPU Time').addTime(this._gpuTimeQuery.getTimerMilliseconds());\n      }\n\n      if (this._gpuTimeQuery) {\n        this._gpuTimeQuery.beginTimeElapsedQuery();\n      }\n\n      this.cpuTime.timeStart();\n    }\n  }, {\n    key: \"_endTimers\",\n    value: function _endTimers() {\n      this.cpuTime.timeEnd();\n\n      if (this._gpuTimeQuery) {\n        this._gpuTimeQuery.end();\n      }\n    }\n  }, {\n    key: \"_startEventHandling\",\n    value: function _startEventHandling() {\n      var canvas = this.gl.canvas;\n\n      if (canvas) {\n        canvas.addEventListener('mousemove', this._onMousemove);\n        canvas.addEventListener('mouseleave', this._onMouseleave);\n      }\n    }\n  }, {\n    key: \"_onMousemove\",\n    value: function _onMousemove(e) {\n      this.animationProps._mousePosition = [e.offsetX, e.offsetY];\n    }\n  }, {\n    key: \"_onMouseleave\",\n    value: function _onMouseleave(e) {\n      this.animationProps._mousePosition = null;\n    }\n  }]);\n  return AnimationLoop;\n}();\n\nexports[\"default\"] = AnimationLoop;\n//# sourceMappingURL=animation-loop.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","_interopRequireDefault","Object","defineProperty","value","_typeof2","_regenerator","_asyncToGenerator2","_classCallCheck2","_createClass2","_gltools","_webgl","_env","isPage","isBrowser","document","statIdCounter","AnimationLoop","props","arguments","length","undefined","_props$onCreateContex","onCreateContext","opts","createGLContext","_props$onAddHTML","onAddHTML","_props$onInitialize","onInitialize","_props$onRender","onRender","_props$onFinalize","onFinalize","onError","_props$gl","gl","_props$glOptions","glOptions","_props$debug","debug","_props$createFramebuf","createFramebuffer","_props$autoResizeView","autoResizeViewport","_props$autoResizeDraw","autoResizeDrawingBuffer","_props$stats","stats","lumaStats","get","concat","_props$useDevicePixel","useDevicePixels","log","deprecated","useDevicePixelRatio","timeline","needsRedraw","cpuTime","gpuTime","frameRate","_running","_initialized","_resolveNextFrame","_nextFramePromise","_animationFrameId","_cpuStartTime","setProps","start","bind","stop","_pageLoadPromise","_onMousemove","_onMouseleave","key","_delete","_setDisplay","setNeedsRedraw","reason","assert","_this","startPromise","_getPageLoadPromise","then","_createWebGLContext","_createFramebuffer","_startEventHandling","_initializeCallbackData","_updateCallbackData","_resizeCanvasDrawingBuffer","_resizeViewport","_gpuTimeQuery","Query","isSupported","animationProps","appContext","_addCallbackData","_startLoop","redraw","_beginTimers","_setupFrame","_renderFrame","_clearNeedsRedraw","offScreen","commit","_endTimers","_finalizeCallbackData","cancelAnimationFrame","attachTimeline","detachTimeline","waitForRender","_this2","Promise","resolve","_toDataURL","mark","_callee","wrap","_callee$","_context","prev","next","abrupt","canvas","toDataURL","apply","_this$props","_this$props2","_this$props3","_this$props4","getHTMLControlValue","id","defaultValue","element","getElementById","Number","setViewParameters","removed","_this3","_requestAnimationFrame","renderFrame","reject","readyState","window","addEventListener","display","animationLoop","renderFrameCallback","requestAnimationFrame","_this$display","_onSetupFrame","_resizeFramebuffer","framebuffer","startTime","Date","now","engineTime","tick","tock","time","_timeline","_loop","_animationLoop","_mousePosition","_this$_getSizeAndAspe","_getSizeAndAspect","width","height","aspect","update","Math","floor","getTime","_offScreen","assign","OffscreenCanvas","instrumentGLContext","isWebGL","Error","resetParameters","_createInfoDiv","wrapperDiv","createElement","body","appendChild","style","position","div","left","bottom","background","html","innerHTML","drawingBufferWidth","drawingBufferHeight","clientHeight","clientWidth","viewport","resizeGLContext","Framebuffer","resize","timeEnd","timeStart","isResultAvailable","isTimerDisjoint","addTime","getTimerMilliseconds","beginTimeElapsedQuery","end","e","offsetX","offsetY"]
}
