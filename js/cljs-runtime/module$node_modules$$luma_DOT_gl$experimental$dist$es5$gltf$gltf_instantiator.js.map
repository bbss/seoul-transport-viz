{
"version":3,
"file":"module$node_modules$$luma_DOT_gl$experimental$dist$es5$gltf$gltf_instantiator.js",
"lineCount":10,
"mappings":"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",
"sources":["node_modules/@luma_DOT_gl/experimental/dist/es5/gltf/gltf-instantiator.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$luma_DOT_gl$experimental$dist$es5$gltf$gltf_instantiator\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _math = require(\"math.gl\");\n\nvar _webgl = require(\"@luma.gl/webgl\");\n\nvar _scenegraph = require(\"../scenegraph/\");\n\nvar _gltfAnimator = _interopRequireDefault(require(\"./gltf-animator\"));\n\nvar _createGltfModel = _interopRequireDefault(require(\"./create-gltf-model\"));\n\nvar ATTRIBUTE_TYPE_TO_COMPONENTS = {\n  SCALAR: 1,\n  VEC2: 2,\n  VEC3: 3,\n  VEC4: 4,\n  MAT2: 4,\n  MAT3: 9,\n  MAT4: 16\n};\nvar DEFAULT_OPTIONS = {\n  modelOptions: {},\n  pbrDebug: false,\n  imageBasedLightingEnvironment: null,\n  lights: true,\n  useTangents: false\n};\n\nvar GLTFInstantiator = function () {\n  function GLTFInstantiator(gl) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    (0, _classCallCheck2[\"default\"])(this, GLTFInstantiator);\n    this.gl = gl;\n    this.options = Object.assign({}, DEFAULT_OPTIONS, options);\n  }\n\n  (0, _createClass2[\"default\"])(GLTFInstantiator, [{\n    key: \"instantiate\",\n    value: function instantiate(gltf) {\n      var _this = this;\n\n      this.gltf = gltf;\n      var scenes = (gltf.scenes || []).map(function (scene) {\n        return _this.createScene(scene);\n      });\n      return scenes;\n    }\n  }, {\n    key: \"createAnimator\",\n    value: function createAnimator() {\n      if (Array.isArray(this.gltf.animations)) {\n        return new _gltfAnimator[\"default\"](this.gltf);\n      }\n\n      return null;\n    }\n  }, {\n    key: \"createScene\",\n    value: function createScene(gltfScene) {\n      var _this2 = this;\n\n      var gltfNodes = gltfScene.nodes || [];\n      var nodes = gltfNodes.map(function (node) {\n        return _this2.createNode(node);\n      });\n      var scene = new _scenegraph.GroupNode({\n        id: gltfScene.name || gltfScene.id,\n        children: nodes\n      });\n      return scene;\n    }\n  }, {\n    key: \"createNode\",\n    value: function createNode(gltfNode) {\n      var _this3 = this;\n\n      if (!gltfNode._node) {\n        var gltfChildren = gltfNode.children || [];\n        var children = gltfChildren.map(function (child) {\n          return _this3.createNode(child);\n        });\n\n        if (gltfNode.mesh) {\n          children.push(this.createMesh(gltfNode.mesh));\n        }\n\n        var node = new _scenegraph.GroupNode({\n          id: gltfNode.name || gltfNode.id,\n          children: children\n        });\n\n        if (gltfNode.matrix) {\n          node.setMatrix(gltfNode.matrix);\n        } else {\n          node.matrix.identity();\n\n          if (gltfNode.translation) {\n            node.matrix.translate(gltfNode.translation);\n          }\n\n          if (gltfNode.rotation) {\n            var rotationMatrix = new _math.Matrix4().fromQuaternion(gltfNode.rotation);\n            node.matrix.multiplyRight(rotationMatrix);\n          }\n\n          if (gltfNode.scale) {\n            node.matrix.scale(gltfNode.scale);\n          }\n        }\n\n        gltfNode._node = node;\n      }\n\n      return gltfNode._node;\n    }\n  }, {\n    key: \"createMesh\",\n    value: function createMesh(gltfMesh) {\n      var _this4 = this;\n\n      if (!gltfMesh._mesh) {\n        var gltfPrimitives = gltfMesh.primitives || [];\n        var primitives = gltfPrimitives.map(function (gltfPrimitive, i) {\n          return _this4.createPrimitive(gltfPrimitive, i, gltfMesh);\n        });\n        var mesh = new _scenegraph.GroupNode({\n          id: gltfMesh.name || gltfMesh.id,\n          children: primitives\n        });\n        gltfMesh._mesh = mesh;\n      }\n\n      return gltfMesh._mesh;\n    }\n  }, {\n    key: \"getVertexCount\",\n    value: function getVertexCount(attributes) {\n      _webgl.log.warn('getVertexCount() not found')();\n    }\n  }, {\n    key: \"createPrimitive\",\n    value: function createPrimitive(gltfPrimitive, i, gltfMesh) {\n      return (0, _createGltfModel[\"default\"])(this.gl, Object.assign({\n        id: gltfPrimitive.name || \"\".concat(gltfMesh.name || gltfMesh.id, \"-primitive-\").concat(i),\n        drawMode: gltfPrimitive.mode || 4,\n        vertexCount: gltfPrimitive.indices ? gltfPrimitive.indices.count : this.getVertexCount(gltfPrimitive.attributes),\n        attributes: this.createAttributes(gltfPrimitive.attributes, gltfPrimitive.indices),\n        material: gltfPrimitive.material\n      }, this.options));\n    }\n  }, {\n    key: \"createAttributes\",\n    value: function createAttributes(attributes, indices) {\n      var _this5 = this;\n\n      var loadedAttributes = {};\n      Object.keys(attributes).forEach(function (attrName) {\n        loadedAttributes[attrName] = _this5.createAccessor(attributes[attrName], _this5.createBuffer(attributes[attrName], _this5.gl.ARRAY_BUFFER));\n      });\n\n      if (indices) {\n        loadedAttributes.indices = this.createAccessor(indices, this.createBuffer(indices, this.gl.ELEMENT_ARRAY_BUFFER));\n      }\n\n      _webgl.log.info(4, 'glTF Attributes', {\n        attributes: attributes,\n        indices: indices,\n        generated: loadedAttributes\n      })();\n\n      return loadedAttributes;\n    }\n  }, {\n    key: \"createBuffer\",\n    value: function createBuffer(attribute, target) {\n      if (!attribute.bufferView) {\n        attribute.bufferView = {};\n      }\n\n      var bufferView = attribute.bufferView;\n\n      if (!bufferView.lumaBuffers) {\n        bufferView.lumaBuffers = {};\n      }\n\n      if (!bufferView.lumaBuffers[target]) {\n        bufferView.lumaBuffers[target] = new _webgl.Buffer(this.gl, {\n          id: \"from-\".concat(bufferView.id),\n          data: bufferView.data || attribute.value,\n          target: target\n        });\n      }\n\n      return bufferView.lumaBuffers[target];\n    }\n  }, {\n    key: \"createAccessor\",\n    value: function createAccessor(accessor, buffer) {\n      return new _webgl.Accessor({\n        buffer: buffer,\n        offset: accessor.byteOffset || 0,\n        stride: accessor.bufferView.byteStride || 0,\n        type: accessor.componentType,\n        size: ATTRIBUTE_TYPE_TO_COMPONENTS[accessor.type]\n      });\n    }\n  }, {\n    key: \"createSampler\",\n    value: function createSampler(gltfSampler) {\n      return gltfSampler;\n    }\n  }, {\n    key: \"needsPOT\",\n    value: function needsPOT() {\n      return false;\n    }\n  }]);\n  return GLTFInstantiator;\n}();\n\nexports[\"default\"] = GLTFInstantiator;\n//# sourceMappingURL=gltf-instantiator.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","_interopRequireDefault","Object","defineProperty","value","_classCallCheck2","_createClass2","_math","_webgl","_scenegraph","_gltfAnimator","_createGltfModel","ATTRIBUTE_TYPE_TO_COMPONENTS","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","DEFAULT_OPTIONS","modelOptions","pbrDebug","imageBasedLightingEnvironment","lights","useTangents","GLTFInstantiator","gl","options","arguments","length","undefined","assign","key","instantiate","gltf","_this","map","scenes","scene","createScene","createAnimator","Array","isArray","animations","gltfScene","_this2","nodes","node","createNode","GroupNode","id","name","children","gltfNode","_this3","_node","child","mesh","push","createMesh","matrix","setMatrix","identity","translation","translate","rotation","rotationMatrix","fromQuaternion","Matrix4","multiplyRight","scale","gltfMesh","_this4","_mesh","primitives","gltfPrimitive","i","createPrimitive","getVertexCount","attributes","log","warn","concat","drawMode","mode","vertexCount","indices","count","createAttributes","material","_this5","loadedAttributes","keys","forEach","attrName","createAccessor","createBuffer","ARRAY_BUFFER","ELEMENT_ARRAY_BUFFER","info","generated","attribute","target","bufferView","lumaBuffers","Buffer","data","accessor","buffer","Accessor","offset","byteOffset","stride","byteStride","type","componentType","size","createSampler","gltfSampler","needsPOT"]
}
